(()=>{"use strict";var e={455:(e,t,i)=>{i.d(t,{DI:()=>n,SO:()=>o,eI:()=>s,vC:()=>a}),i(294);var r=i(541),a={};function o(e,t){return t.sceneoverlays=[...e.overlays],t}function n(e,t){return t.canvaswidth=e.canvas.width,t.canvasheight=e.canvas.height,t.scenewidth=e.getFrameWidth(),t.sceneheight=e.getFrameHeight(),t.sceneendx=e.getFrameEndx(),t.sceneendy=e.getFrameEndy(),t.defaultx=e.defaultx,t.defaulty=e.defaulty,t.scenebordercolor=e.bordercolor,t.scenebackcolor=e.backcolor,t.sceneborderthickness=e.borderthickness,t.backgroundimg=e.backgroundimg,r.x.usemaincanvas&&(t.mainCanvasContext=r.x.objMainCtx),e.backgroundeffects.forEach((e=>{e.mainAlpha.current&&(t.backgroundAlpha=e.mainAlpha.current)})),t}function s(e,t){return t.sceneoverlays=null,null!=e.offscreenImage?t.video=e.offscreenImage:(t.mainCanvasContext=r.x.objMainCtx,t.video=e.realvideo),t.isMirrorVideo=e.isMirrorVideo,t.mediaborderthickness=e.borderthickness,t.mediabordercolor=e.bordercolor,t.videocropy=e.videocropy.current,t.videocroph=e.videocroph.current,t.videocropw=e.videocropw.current,t.videocropx=e.videocropx.current,t.x=e.x.current,t.y=e.y.current,t.w=e.w.current,t.h=e.h.current,t.mediaAlpha=e.initialAlpha,e.overlays&&0!=e.overlays.length&&(t.overlays=[...e.overlays]),0!=e.effects.length&&e.effects.forEach((e=>{e.mainAlpha.current&&(t.mediaAlpha=e.mainAlpha.current)})),t}},294:(e,t,i)=>{function r(e,t=null){this.scene=e,this.objParent=t||null,this.EffectsInit=e=>{e.forEach((e=>{e.effects&&e.effects.forEach((t=>{e.CopyTargetsFromEffect(t),t.InitStart()})),e.overlays&&e.overlays.length>0&&this.EffectsInit(e.overlays)}))},this.SetOverlayAlignment=(t,i=this.objParent)=>{switch(t.left_or_right){case"left":t.x.relative=i?i.x.current+t.x.initial:this.scene.defaultx+t.x.initial;break;case"right":t.x.relative=i?i.x.current+i.w.current-t.x.initial:e.getFrameEndx()-t.w.target-t.x.initial;break;default:throw"Error, Overlay left or right alignment not specified."}switch(t.top_or_bottom){case"top":t.y.relative=i?i.y.current+t.y.initial:this.scene.defaulty+t.y.initial;break;case"bottom":t.y.relative=i?i.y.current+i.h.current-t.h.current-t.y.initial:this.scene.getFrameEndy()-t.h.current-t.y.initial;break;default:throw"Error!! Overlay top or bottom alignment not specified"}},this.EffectsBeforeDraw=(e,t=this.objParent)=>{e.forEach((e=>{var i;this.SetOverlayAlignment(e,t),e.RecalculatePosition(),1!=void((i=e.effects)&&i.length>0&&i.forEach((e=>{if("movencropfx"==e.type)return!0})))&&e.ApplyTargets(),e.ApplyEffects(),e.effects&&e.effects.forEach((e=>{e.beforeDraw()})),e.overlays&&e.overlays.length>0&&this.EffectsBeforeDraw(e.overlays,e)}))},Array.prototype.remove=function(e){return-1!=this.indexOf(e)&&(this.splice(this.indexOf(e),1),!0)},this.EffectsAfterDraw=e=>{e.forEach((t=>{t.effects&&t.effects.forEach((i=>{i.afterDraw(),1==i.completed&&(i.removefromscene&&e.splice(e.indexOf(t),1),t.effects.remove(i))})),t.overlays&&t.overlays.length>0&&this.EffectsAfterDraw(t.overlays)}))}}i.d(t,{r:()=>r}),i(541)},541:(e,t,i)=>{i.d(t,{x:()=>v});var r=i(871);class a{constructor(e){this.name=e,this.divTag=this.createTag(e)}writeLogs(e,t=this.name){document.getElementById(t)?document.getElementById(t).innerHTML=e:this.createTag(t),document.getElementById(t).innerHTML=e}createTag(e){let t=(new r.d).createDivTag(e);return t.Id=e,document.body.appendChild(t),t}}var o=i(455),n=new function(){this.EffectsInit=e=>{e.backgroundeffects.forEach((e=>{0==e.initdone&&(e.InitStart(),e.initdone=!0)}))},this.EffectsBeforeDraw=e=>{e.backgroundeffects.forEach((t=>{"colorFadefx"==t.type&&(e.backcolor=t.backcolor.toRGBAString("current")),t.beforeDraw()}))},this.EffectsAfterDraw=e=>{e.backgroundeffects.forEach((t=>{t.afterDraw(),1==t.completed&&(t.initdone=!1,1==t.removefromscene&&(e.backgroundimg=""),e.backgroundeffects.splice(e.backgroundeffects.indexOf(t),1))}))}},s={},c=!1,d={},l=!1;var h={},u=!1;const p=(u||(u=!0,g=h,m=function(e,t){var i,r=null,a=(i=t.load,function(){if(null!==r)return r;var e=new Blob(['(()=>{var e={67:(e,t,r)=>{var o,i;void 0===(i="function"==typeof(o=function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)},o=function(e){var r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)},i=function(e,t){var r,o=performance.now();return{expected:o+(r=e-Math.max(0,o-t)),remainingDelay:r}},n=function e(t,r,o,i){var n=performance.now();n>o?postMessage({id:null,method:"call",params:{timerId:r,timerType:i}}):t.set(r,setTimeout(e,o-n,t,r,o,i))},a=function(t,r,o){var a=i(t,o),s=a.expected,d=a.remainingDelay;e.set(r,setTimeout(n,d,e,r,s,"interval"))},s=function(e,r,o){var a=i(e,o),s=a.expected,d=a.remainingDelay;t.set(r,setTimeout(n,d,t,r,s,"timeout"))};addEventListener("message",(function(e){var t=e.data;try{if("clear"===t.method){var i=t.id,n=t.params,d=n.timerId,c=n.timerType;if("interval"===c)r(d),postMessage({error:null,id:i});else{if("timeout"!==c)throw new Error(\'The given type "\'.concat(c,\'" is not supported\'));o(d),postMessage({error:null,id:i})}}else{if("set"!==t.method)throw new Error(\'The given method "\'.concat(t.method,\'" is not supported\'));var u=t.params,l=u.delay,p=u.now,m=u.timerId,v=u.timerType;if("interval"===v)a(l,m,p);else{if("timeout"!==v)throw new Error(\'The given type "\'.concat(v,\'" is not supported\'));s(l,m,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}}))})?o.call(t,r,t,e):o)||(e.exports=i)}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(67)})()})();'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return(r=i(t)).setTimeout((function(){return URL.revokeObjectURL(t)}),0),r});e.clearInterval=function(e){return a().clearInterval(e)},e.clearTimeout=function(e){return a().clearTimeout(e)},e.setInterval=function(e,t){return a().setInterval(e,t)},e.setTimeout=function(e,t){return a().setTimeout(e,t)},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof h?m(h,function(){return l||(l=!0,e=d,t=function(e,t){e.load=function(e){var i=new Map([[0,function(){}]]),r=new Map([[0,function(){}]]),a=new Map,o=new Worker(e);return o.addEventListener("message",(function(e){var t=e.data;if(function(e){return void 0!==e.method&&"call"===e.method}(t)){var o=t.params,n=o.timerId,s=o.timerType;if("interval"===s){var c=i.get(n);if("number"==typeof c){var d=a.get(c);if(void 0===d||d.timerId!==n||d.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if(void 0===c)throw new Error("The timer is in an undefined state.");c()}}else if("timeout"===s){var l=r.get(n);if("number"==typeof l){var h=a.get(l);if(void 0===h||h.timerId!==n||h.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if(void 0===l)throw new Error("The timer is in an undefined state.");l(),r.delete(n)}}}else{if(!function(e){return null===e.error&&"number"==typeof e.id}(t)){var u=t.error.message;throw new Error(u)}var p=t.id,g=a.get(p);if(void 0===g)throw new Error("The timer is in an undefined state.");var m=g.timerId,f=g.timerType;a.delete(p),"interval"===f?i.delete(m):r.delete(m)}})),{clearInterval:function(e){var r=t.generateUniqueNumber(a);a.set(r,{timerId:e,timerType:"interval"}),i.set(e,r),o.postMessage({id:r,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var i=t.generateUniqueNumber(a);a.set(i,{timerId:e,timerType:"timeout"}),r.set(e,i),o.postMessage({id:i,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e,r){var a=t.generateUniqueNumber(i);return i.set(a,(function(){e(),"function"==typeof i.get(a)&&o.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:a,timerType:"interval"}})})),o.postMessage({id:null,method:"set",params:{delay:r,now:performance.now(),timerId:a,timerType:"interval"}}),a},setTimeout:function(e,i){var a=t.generateUniqueNumber(r);return r.set(a,e),o.postMessage({id:null,method:"set",params:{delay:i,now:performance.now(),timerId:a,timerType:"timeout"}}),a}}},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof d?t(d,(c||(c=!0,function(e,t){"object"==typeof s?t(s):"function"==typeof define&&i.amdO?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).fastUniqueNumbers={})}(s,(function(e){var t,i=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,r=1073741824,a=new WeakMap,o=function(e,t){return function(a){var o=t.get(a),n=void 0===o?a.size:o<r?o+1:0;if(!a.has(n))return e(a,n);if(a.size<536870912){for(;a.has(n);)n=Math.floor(Math.random()*r);return e(a,n)}if(a.size>i)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;a.has(n);)n=Math.floor(Math.random()*i);return e(a,n)}}((t=a,function(e,i){return t.set(e,i),i}),a),n=function(e){return function(t){var i=e(t);return t.add(i),i}}(o);e.addUniqueNumber=n,e.generateUniqueNumber=o,Object.defineProperty(e,"__esModule",{value:!0})}))),s)):"function"==typeof define&&i.amdO?define(["exports","fast-unique-numbers"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).workerTimersBroker={},e.fastUniqueNumbers)),d;var e,t}()):"function"==typeof define&&i.amdO?define(["exports","worker-timers-broker"],m):m((g="undefined"!=typeof globalThis?globalThis:g||self).workerTimers={},g.workerTimersBroker)),h);var g,m;function f(){this.PlayOnCanvas=function(e){this.drawmedia=()=>{var t;!function(e){o.vC.offscreenImage=null,n.EffectsInit(e),n.EffectsBeforeDraw(e);var t=(0,o.DI)(e,o.vC);e.pen.PreDraw(e.ctx,t),n.EffectsAfterDraw(e)}(e),0!=(t=e.sortmedia).length&&t.forEach((e=>{e.draw()})),function(e){e.draw()}(e)},p.setInterval((()=>{this.drawmedia()}),1e3/30)}}class v{static studioWidth=1280;static studioHeight=720;static dummycanvasctx=(new r.d).createCanvasTag(1,1,!1).getContext("2d");static useoffscreencanvas=!1;static usemaincanvas=!0;static objMainCtx;static objMainOffScreenCtx;static maincanvas;static scenes=new Array;static logs=new a("logs");static columnlayoutlogs=new a("columnlayout");static objTimeline=new f;static runningeffects=new Array;static completedeffects=new Array;static selectedSceneObj}},513:(e,t,i)=>{i.d(t,{N:()=>z});var r=i(541),a=i(294),o=i(455);function n(e,t,i,n,s,c,d){if(this.drawVariables=o.vC,this.overlays=new Array,this.pen=new Pen,this.defaultx=n,this.defaulty=s,this.defaultright=c,this.defaultbottom=d,this.name=e,this.canvas=t,this.isoffscreencanvas=i,this.overlayeffectsmanager=new a.r(this,null),this.isoffscreencanvas){const e=new Worker("canvas-worker.js");this.worker=e,this.sceneoffscreencanvas=t.transferControlToOffscreen(),1==r.x.usemaincanvas&&(this.mainoffscreencanvas=r.x.maincanvas),this.worker.postMessage({sceneoffscreencanvas:this.sceneoffscreencanvas},[this.sceneoffscreencanvas]),1==r.x.usemaincanvas&&this.worker.postMessage({mainoffscreencanvas:this.mainoffscreencanvas},[this.mainoffscreencanvas])}else this.ctx=t.getContext("2d");this.backcolor="#000000",this.bordercolor="#000000",this.borderthickness=2,this.backgroundimg="",this.backgroundvideo="",this.backgroundeffects=new Array,this.backgroundoverlays=new Array,this.defaultx=0,this.defaulty=0,this.defaultbottom=0,this.defaultright=0,this.getFrameWidth=function(e=this.canvas){return e.width-this.defaultright-this.defaulty},this.getFrameHeight=function(e=this.canvas){return e.height-this.defaultbottom-this.defaultx},this.getFrameEndx=function(e=this.canvas){return this.frameendx=e.width-this.defaultright,this.frameendx},this.getFrameEndy=function(e=this.canvas){return this.frameendy=e.height-this.defaultbottom,this.frameendy},this.completedeffects=new Array,this.allmedia=new Array,this.allmediacopy=new Array,this.sortmedia=new Array,this.draw=()=>{this.overlayeffectsmanager.EffectsInit(this.overlays),this.overlayeffectsmanager.EffectsBeforeDraw(this.overlays);var e=(0,o.SO)(this,this.drawVariables);this.pen.PenDraw(this.ctx,e),this.overlayeffectsmanager.EffectsAfterDraw(this.overlays)},this.bringToFront=e=>{this.sortmedia=[...this.allmedia],this.sortmedia.push(this.sortmedia.splice(this.sortmedia.indexOf(e),1)[0])}}var s=i(871);class c{timelinestarted=!1;objhtml=new s.d;CreateMainCanvas(e){if(r.x.usemaincanvas){let t=this.objhtml.createCanvasTag(e,r.x.studioWidth,r.x.studioHeight,r.x.usemaincanvas);r.x.maincanvas=t,r.x.useoffscreencanvas?r.x.maincanvas=t.transferControlToOffscreen():r.x.objMainCtx=r.x.maincanvas.getContext("2d")}}CreateScene(e){let t=new n(e,this.objhtml.createCanvasTag(e,r.x.studioWidth,r.x.studioHeight,!r.x.usemaincanvas),r.x.useoffscreencanvas,0,0,0,0);r.x.scenes.push(t)}StartTimeline(e){1!=this.timelinestarted&&(r.x.objTimeline.PlayOnCanvas(e),this.timelinestarted=!0)}SelectedScene(e){let t=r.x.scenes.findIndex((t=>t.name===e));return null==t&&-1==t||(r.x.selectedSceneObj=r.x.scenes[t]),r.x.selectedSceneObj}isMirrorVideo(e){r.x.scenes[0].isMirrorVideo=e}}class d{constructor(e=null,t=null,i=null,r=null,a=[{current:null,subtarget:null,speed:null}],o=null){this.ThingPropertyTimeline=!0,this.initial=e,this.start=t,this.current=i,this.target=r,this.submovement=a,this.relative=o}get relative(){return this._relative}set relative(e){isNaN(e),this._relative=e}get target(){return this._target}set target(e){isNaN(e),this._target=e}set initial(e){this._initial=e}get initial(){return this._initial}set start(e){this._start=e}get start(){return this._start}set current(e){this._current=e}get current(){return this._current}ApplyInitials(e){this.initial=e,this.start=e,this.current=e,this.relative=e}ApplyAll(e){this.ApplyInitials(e),this.target=e}ApplyTarget(e){this.target=e}}class l{constructor(e=null,t=null){this.r=new d,this.g=new d,this.b=new d,this.a=new d,this.SetColor(t,"target"),this.SetColor(e,"current"),this.SetColor(e,"initial"),this.SetColor(e,"start")}set r(e){this._r=e}get r(){return this._r}set g(e){this._g=e}get g(){return this._g}set b(e){this._b=e}get b(){return this._b}set a(e){this._a=e}get a(){return this._a}ApplyAll(e,t){this.r.ApplyAll(e.r[t]),this.g.ApplyAll(e.g[t]),this.b.ApplyAll(e.b[t]),this.a.ApplyAll(e.a[t])}SetColor(e,t){if(e)for(var i in e)this[i][t]=e[i],null==this[i][t]&&(this[i][t]=0)}toRGBAString(e,t=this){return t.a[e]?"rgba("+t.r[e]+","+t.g[e]+","+t.b[e]+","+t.a[e]+")":"rgba("+t.r[e]+","+t.g[e]+","+t.b[e]+")"}}class h{constructor(e){this.type="not set? or is ThingProperty the problem?",this.name=e,this.x=new d,this.y=new d,this.w=new d,this.h=new d,this.radius=new d,this.mainAlpha=new d,this.forecolor=new l,this.bordercolor=new l}set x(e){this._x=e}get x(){return this._x}set y(e){this._y=e}get y(){return this._y}set w(e){this._w=e}get w(){return this._w}set h(e){this._h=e}get h(){return this._h}set radius(e){this._radius=e}get radius(){return this._radius}set mainAlpha(e){this._mainAlpha=e}get mainAlpha(){return this._mainAlpha}set bordercolor(e){this._bordercolor=e}get bordercolor(){return this._bordercolor}set forecolor(e){this._forecolor=e}get forecolor(){return this._forecolor}}class u extends h{constructor(e){super(e)}ApplyNewTargets(){for(var e in this)if(e.ThingPropertyTimeline)for(var t in e)null!=t.target&&(t.current=t.target)}ApplyTargets(){this.x.current=this.x.target,this.y.current=this.y.target,this.w.current=this.w.target,this.h.current=this.h.target}ApplyRelative(){for(var e in this.thingproperty)for(var t in e)null!=t.relative&&(t.current=t.relative)}ApplyCurrentColors(e,t){t.backcolor&&(e.backcolor.r.current=t.backcolor.r.current,e.backcolor.g.current=t.backcolor.g.current,e.backcolor.b.current=t.backcolor.b.current,e.backcolor.a.current=t.backcolor.a.current),t.bordercolor&&t.bordercolor.r.current&&(e.bordercolor.r.current=t.bordercolor.r.current,e.bordercolor.g.current=t.bordercolor.g.current,e.bordercolor.b.current=t.bordercolor.b.current,e.bordercolor.a.current=t.bordercolor.a.current)}CopyTargetsFromEffect(e){this.x.target?e.x.target=this.x.target:e.x.target=0,this.y.target?e.y.target=this.y.target:e.y.target=0,this.w.target?e.w.target=this.w.target:e.w.target=0,this.h.target?e.h.target=this.h.target:e.h.target=0,"colorFadefx"==e.type&&(this.setColorTargets(e.backcolor,this.backcolor,"target"),this.setColorTargets(e.bordercolor,this.bordercolor,"target"))}setColorTargets(e,t,i="target"){if(e)for(var r in t)t[r][i]=e[r][i]}ApplyEffects(e=null){var t=null;(t=e&&e.length>0?e:[this]).forEach((e=>{e.effects&&e.effects.length>0&&e.effects.forEach((t=>{t.x.current&&(e.x.current=t.x.current),t.y.current&&(e.y.current=t.y.current),t.w.current&&(e.w.current=t.w.current),t.h.current&&(e.h.current=t.h.current),this.ApplyCurrentColors(e,t),null!=t.mainAlpha.current&&(e.mainAlpha.current=t.mainAlpha.current)}))})),t.forEach((e=>{e.overlays&&e.overlays.length>0&&this.ApplyEffects(e.overlays)}))}}class p extends h{constructor(e){super(e),this.videocropx=new d,this.videocropy=new d,this.videocropw=new d,this.videocroph=new d}}class g extends p{constructor(e){super(e)}ApplyNewTargets(){for(var e in this.thingproperty)for(var t in e)null!=t.target&&(t.current=t.target)}ApplyTargets(){this.x.current=this.x.target,this.y.current=this.y.target,this.w.current=this.w.target,this.h.current=this.h.target}ApplyEffects(e=null){var t=null;(t=e&&e.length>0?e:[this]).forEach((e=>{e.effects&&e.effects.length>0&&e.effects.forEach((t=>{t.x.current&&(e.x.current=t.x.current),t.y.current&&(e.y.current=t.y.current),t.w.current&&(e.w.current=t.w.current),t.h.current&&(e.h.current=t.h.current),null!=t.mainAlpha.current&&(e.mainAlpha.current=t.mainAlpha.current)}))})),t.forEach((e=>{e.overlays&&e.overlays.length>0&&this.ApplyEffects(e.overlays)}))}}class m extends g{constructor(e,t,i,r,a,o,n,s,c,l=new d,h=new d){super(e),this.name=e,this.initialcroph=i.videoHeight,this.initialcropw=i.videoWidth,this.videocropw.current=i.videoWidth,this.videocroph.current=i.videoHeight,this.videoheight=i.videoHeight,this.videowidth=i.videoWidth,this.videoduration=i.duration,this.bordercolor="green",this.borderthickness=1,this.realvideo=i,this.scene=r,this.ctx=this.scene.ctx,this.x.initial=a,this.y.initial=o,this.w.initial=i.videoWidth,this.h.initial=i.videoHeight,this.initialcropx=l,this.initialcropy=h,this.framewidth=r.getFrameWidth(),this.frameheight=r.getFrameHeight(),this.x.current=a+r.defaultx,this.y.current=o+r.defaulty,this.w.current=i.videoWidth,this.h.current=i.videoHeight,this.videocropx.current=l.current,this.videocropy.current=h.current,this.x.target=this.x.current,this.y.target=this.y.current,this.w.target=this.w.current,this.h.target=this.h.current,this.videocropx.target=this.videocropx.current,this.videocropy.target=this.videocropy.current,this.videocropw.target=this.videocropw.current,this.videocroph.target=this.videocroph.current,this.isMirrorVideo=c,this.normalAlpha=1,this.mediaAlpha=this.normalAlpha,this.initialAlpha=t,0==this.initialAlpha&&(this.mediaAlpha=this.initialAlpha,this.initialAlpha=this.normalAlpha),this.effects=new Array,this.overlays=new Array,this.num=0,this.realvideo.addEventListener("resize",(e=>{this.num++,console.log("-------------------------------------------------------"),console.log(e.target.videoWidth+this.num),this.num>1&&(window.innerHeight>window.innerWidth?(this.videocropx.current=0,this.videocropy.current=(i.videoHeight-9*i.videoWidth/16)/2,this.videocropw.current=i.videoWidth,this.videocroph.current=9*i.videoWidth/16):(this.videocropx.current=(i.videoWidth-16*i.videoHeight/9)/2,this.videocropy.current=0,this.videocropw.current=16*i.videoHeight/9,this.videocroph.current=i.videoHeight))}))}}function f(e,t){this.objVisualMedia=t,this.mediabox=t.mediabox,this.scene=e,this.overlayeffectsmanager=new a.r(this.scene,this.mediabox),this.isNaNorUndefined=e=>!(!isNaN(e)&&void 0!==e),this.clearTargets=e=>{e.x.target=0,e.y.target=0,e.w.target=0,e.h.target=0,e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=0,e.videocroph.target=0},this.AssignMediaboxTargetsToEffect=(e,t)=>{this.isNaNorUndefined(t.x.current)?e.x.current=0:e.x.current=Math.abs(t.x.current),this.isNaNorUndefined(t.y.current)?e.y.current=0:e.y.current=Math.abs(t.y.current),this.isNaNorUndefined(t.w.current)?e.w.current=0:e.w.current=Math.abs(t.w.current),this.isNaNorUndefined(t.h.current)?e.h.current=0:e.h.current=Math.abs(t.h.current),this.isNaNorUndefined(t.videocropx.current)?e.videocropx.current=0:e.videocropx.current=Math.abs(t.videocropx.current),this.isNaNorUndefined(t.videocropy.current)?e.videocropy.current=0:e.videocropy.current=Math.abs(t.videocropy.current),this.isNaNorUndefined(t.videocropw.current)?e.videocropw.current=0:e.videocropw.current=Math.abs(t.videocropw.current),this.isNaNorUndefined(t.videocroph.current)?e.videocroph.current=0:e.videocroph.current=Math.abs(t.videocroph.current),e.x.target=this.isNaNorUndefined(Math.abs(t.x.target))?e.x.target=0:e.x.target=t.x.target,e.y.target=this.isNaNorUndefined(Math.abs(t.y.target))?e.y.target=0:e.y.target=t.y.target,e.w.target=this.isNaNorUndefined(Math.abs(t.w.target))?e.w.target=0:e.w.target=t.w.target,e.h.target=this.isNaNorUndefined(Math.abs(t.h.target))?e.h.target=0:e.h.target=t.h.target,this.isNaNorUndefined(t.videocropx.target)?e.videocropx.target=0:e.videocropx.target=Math.abs(t.videocropx.target),this.isNaNorUndefined(t.videocropy.target)?e.videocropy.target=0:e.videocropy.target=Math.abs(t.videocropy.target),this.isNaNorUndefined(t.videocropw.target)?e.videocropw.target=0:e.videocropw.target=Math.abs(t.videocropw.target),this.isNaNorUndefined(t.videocroph.target)?e.videocroph.target=0:e.videocroph.target=Math.abs(t.videocroph.target)},this.AssignEffectToMediabox=(e,t)=>{this.isNaNorUndefined(e.x.current)?t.x.current=0:t.x.current=e.x.current,this.isNaNorUndefined(e.y.current)?t.y.current=0:t.y.current=e.y.current,this.isNaNorUndefined(e.w.current)?t.w.current=0:t.w.current=e.w.current,this.isNaNorUndefined(e.h.current)?t.h.current=0:t.h.current=e.h.current,this.isNaNorUndefined(e.videocropx.current)?t.videocropx.current=0:t.videocropx.current=e.videocropx.current,this.isNaNorUndefined(e.videocropy.current)?t.videocropy.current=0:t.videocropy.current=e.videocropy.current,this.isNaNorUndefined(e.videocropw.current)?t.videocropw.current=0:t.videocropw.current=e.videocropw.current,this.isNaNorUndefined(e.videocroph.current)?t.videocroph.current=0:t.videocroph.current=e.videocroph.current},this.EffectsInit=e=>{this.overlayeffectsmanager.EffectsInit(this.objVisualMedia.overlays),e.forEach((e=>{0==e.initdone&&("movencropfx"==e.type&&this.AssignMediaboxTargetsToEffect(e,this.objVisualMedia.mediabox),e.InitStart(),e.initdone=!0)}))},this.EffectsBeforeDraw=e=>{this.overlayeffectsmanager.EffectsBeforeDraw(this.objVisualMedia.overlays,this.objVisualMedia),e.forEach((e=>{this.objVisualMedia.ApplyEffects(),"movencropfx"==e.type&&this.AssignMediaboxTargetsToEffect(e,this.objVisualMedia.mediabox),e.beforeDraw()}))},Array.prototype.remove=function(e){return-1!=this.indexOf(e)&&(this.splice(this.indexOf(e),1),!0)},this.EffectsAfterDraw=i=>{this.overlayeffectsmanager.EffectsAfterDraw(this.objVisualMedia.overlays),i.forEach((r=>{"movencropfx"==r.type&&this.AssignEffectToMediabox(r,this.objVisualMedia.mediabox),r.afterDraw(),1==r.completed&&(r.initdone=!1,1==r.removefromscene&&e.sortmedia.splice(e.sortmedia.indexOf(t),1),i.remove(r))}))}}Array.prototype.remove=function(e){return-1!=this.indexOf(e)&&(this.splice(this.indexOf(e),1),!0)};class v extends m{constructor(e,t,i,r,n,s,c,l,h,u=new d,p=new d){super(e,t,i,r,n,s,c,l,h,u,p),this.mediabox=this,this.drawVariables=o.vC,this.video=this.realvideo,this.objPen=this.scene.pen,this.scene=r,this.mediaeffectsmanager=new f(this.scene,this),this.overlayeffectsmanager=new a.r(this.scene,this),this.isMirrorVideo=h}listenChangesinArray(e,t){["push"].forEach((i=>{e[i]=function(){var r=Array.prototype[i].apply(e,arguments);return t.apply(e,arguments),r}}))}effectCompleted=e=>{r.x.completedeffects.push(e),objMediaBox.effects.remove(e)};addEffect=async e=>new Promise(((t,i)=>{this.effects.push(e),this.detectednewcompletedeffect=()=>{r.x.completedeffects[r.x.completedeffects.indexOf(e)]==e&&(t(this),r.x.completedeffects.remove(e))},this.listenChangesinArray(r.x.completedeffects,this.detectednewcompletedeffect),setTimeout((()=>{0!=this.effects.length&&(i(this,"timed out..Is this effect stuck for over 10 seconds?"),console.log("rejected"))}),1e4)}));draw=()=>{this.offscreenImage=null,this.mediaeffectsmanager.EffectsInit(this.effects),this.mediaeffectsmanager.EffectsBeforeDraw(this.effects);var e=(0,o.eI)(this,this.drawVariables);this.objPen.PenDraw(this.scene.ctx,e),this.mediaeffectsmanager.EffectsAfterDraw(this.effects)}}class y extends u{constructor(e,t,i,r,a,o,n,s){super(e),this.overlayname=e,this.effects=new Array,s&&(this.effects=s),this.type="imageoverlay",this.image=o,this.mainAlpha.ApplyTarget(n),this.x.ApplyAll(t),this.y.ApplyAll(i),this.w.ApplyTarget(o.naturalWidth),this.h.ApplyTarget(o.naturalHeight),this.left_or_right=r,this.top_or_bottom=a,this.objectwidth=this.image.naturalWidth,this.objectheight=this.image.naturalHeight}RecalculatePosition(){null!=this.x.initial&&(this.x.target=this.x.relative),null!=this.y.initial&&(this.y.target=this.y.relative)}}class x extends u{constructor(e,t,i,r,a,o,n,s,c,d,l,h,u,p,g,m,f,v,y,x,b){super(e),this.overlayname=e,this.type="tickeroverlay",this.effects=new Array,this.x.current=t,this.y.current=i,this.radius=0,this.initialRadius=this.radius,this.targetRadius=this.radius,this.tickerx=t,this.backcolor=l,this.initialBackgroundAlpha=h,this.targetBackgroundAlpha=h,this.backgroundAlpha=h,this.mainAlpha.ApplyTarget(h),this.forecolor=u,this.font=y,this.initialForegroundAlpha=p,this.targetForegroundAlpha=p,this.foregroundAlpha=p,this.bordercolor=g,this.borderthickness=m,this.initialBorderAlpha=f,this.targetBorderAlpha=f,this.borderAlpha=f,this.direction=x,this.speed=b,this.content=v,this.framestartx=n,this.frameendx=s,this.textwidth=c,this.textheight=d,this.left_or_right="left",this.top_or_bottom=o,this.xspacing=r,this.yspacing=a}RecalculatePosition(){"left"==this.direction?(this.x.current=this.x.current-this.speed,parseFloat(this.x.current)<parseFloat(this.framestartx)-txtlength&&(this.x.current=this.frameendx)):(this.x.current=this.x.current+this.speed,parseFloat(this.x.current)>parseFloat(this.frameendx)+parseFloat(this.textwidth)&&(this.x.current=parseFloat(this.framestartx)-parseFloat(this.textwidth)))}ApplyTargets(){}ApplyEffects(){}}class b extends u{constructor(e,t,i,r,a,o,n,s,c,d,l,h,u){super(e),this.name=e,this.overlayname=e,this.effects=new Array,this.effects=u,this.type="rectangleoverlay",this.overlays=new Array,this.initialRadius=o,this.targetRadius=o,this.radius=o,this.bordercolor=l,this.borderthickness=h,this.bordercolor.ApplyAll(l,"current"),this.x.ApplyAll(t),this.y.ApplyAll(i),this.w.ApplyAll(n),this.h.ApplyAll(s),this.mainAlpha.ApplyTarget(d),this.objectwidth=n,this.objectheight=s,this.backcolor=c,this.left_or_right=r,this.top_or_bottom=a}RecalculatePosition(){null!=this.x.initial&&(this.x.target=this.x.relative),null!=this.y.initial&&(this.y.target=this.y.relative);var e=this.CalculateSubOverlaysSize();this.objectwidth=this.w.target+e.w,this.objectheight=this.h.target+e.h}CalculateSubOverlaysSize(){var e=0;return this.overlays&&this.overlays.length>0&&this.overlays.forEach((t=>{"left"==t.left_or_right&&(e+=t.w.target+t.x.target),"right"==t.left_or_right&&(e+=t.w.target)})),{w:e,h:0}}}var w=i(596);class k extends u{objUtil=new w.Z;constructor(e,t,i,r,a,o,n,s,c,d){super(e),this.name=e,this.overlayname=e,this.effects=new Array,this.effects=d,this.type="textoverlay",this.mainAlpha.ApplyAll(n),this.text=s,this.font=c,this.overlays=new Array,this.w.ApplyAll(this.objUtil.measureTextWidth(s,c)),this.h.ApplyAll(this.objUtil.measureTextHeight(c)),this.x.ApplyAll(t),this.y.ApplyAll(i),this.forecolor=o,this.left_or_right=r,this.top_or_bottom=a}RecalculatePosition(){null!=this.x.initial&&(this.x.target=this.x.relative),null!=this.y.initial&&(this.y.target=this.y.relative);var e=this.CalculateSubOverlaysSize();this.w.target=e.w,this.h.target=e.h}CalculateSubOverlaysSize(){var e=0;return this.overlays&&this.overlays.length>0&&this.overlays.forEach((t=>{"left"==t.left_or_right&&(e+=t.w.target+t.x.target,this.initialxspacing,this.xspacing=t.w.target+t.x.relative+this.initialxspacing),"right"==t.left_or_right&&(e+=t.w.target)})),{w:e,h:0}}}class A extends h{constructor(e,t=.01,i=1,r=0){super(e),this.type="fadeinfx",this.initdone=!1,this.mainAlpha.start=r,this.mainAlpha.current=0,this.mainAlpha.target=i,this.completed=!1,this.mainAlpha.target=i,this.mainAlpha.speed=t}InitStart=()=>{0==this.initdone&&(this.initdone=!0)};beforeDraw=()=>{this.mainAlpha.current+=parseFloat(this.mainAlpha.speed)};afterDraw=()=>{this.mainAlpha.current>=this.mainAlpha.target&&(this.mainAlpha.current=this.mainAlpha.target,this.initdone=!1,this.completed=!0)}}let T=new w.Z;class M extends h{constructor(e,t=.01,i=!0){super(e),this.type="fadeoutfx",this.initdone=!1,this.mainAlpha.current=.9,this.mainAlpha.target=.01,this.totaliterations=0,this.currentiteration=0,this.mainAlpha.speed=t,this.completed=!1,this.removefromscene=i,this.InitStart=()=>{0==this.initdone&&(this.initdone=!0,this.totaliterations=this.mainAlpha.current/this.mainAlpha.speed)}}beforeDraw=()=>{if(this.currentiteration++,this.currentiteration<=this.totaliterations){var e=parseFloat(this.mainAlpha.current)-parseFloat(this.mainAlpha.speed);-1!=Math.sign(e)&&(this.mainAlpha.current=e)}};afterDraw=()=>{this.mainAlpha.current<=this.mainAlpha.speed&&(this.mainAlpha.current=0),this.currentiteration>=this.totaliterations&&(this.mainAlpha.current=0,this.initdone=!1,this.completed=!0,this.currentiteration=0)}}let C=new class{CreateTextOverlay(e,t,i,r,a){return this.name=e,this.labeltxt=i,this.font="20px Helvetica",this.left_or_right=r,this.top_or_bottom=a,"top"==a&&"left"==r&&(this.x=T.getPercentageValue(2,t.objectwidth),this.y=T.getPercentageValue(20,t.objectheight)),"bottom"==a&&"left"==r&&(this.x=T.getPercentageValue(2,t.objectwidth),this.y=T.getPercentageValue(60,t.objectheight)),this.forecolor=new l({r:255,g:255,b:255,a:1}),this.mainAlpha=1,this.effects=[new A("textoverlay-fadein",.01)],this.objTextOverlay=new k(this.name,this.x,this.y,this.left_or_right,this.top_or_bottom,this.forecolor,this.mainAlpha,this.labeltxt,"20px Helvetica",this.effects),this.objTextOverlay}CreateRectangleOverlay(e,t,i,r,a){return this.font="20px Helvetica",this.name=e,this.x=10,this.y=4,this.left_or_right=i,this.top_or_bottom=r,this.radius=a,this.textoverlayheight=T.measureTextHeight(this.font),this.textoverlaywidth=T.measureTextWidth(t,this.font),this.rectanglewidth=this.textoverlaywidth+10,this.rectangleheight=this.textoverlayheight+5,this.backcolor=new l({r:0,g:0,b:0,a:1}),this.mainAlpha=1,this.bordercolor=new l({r:0,g:0,b:0,a:1}),this.borderthickness=1,this.effects=[new A("rectangle-fadein",.01,1)],this.objRectangleOverlay=new b(this.name,this.x,this.y,this.left_or_right,this.top_or_bottom,this.radius,this.rectanglewidth,this.rectangleheight,this.backcolor,this.mainAlpha,this.bordercolor,this.borderthickness,this.effects),this.objRectangleOverlay}CreateImageOverlay(e,t,i,r){return this.name=e,this.x=60,this.y=120,this.left_or_right=i,this.top_or_bottom=r,this.imagefilepath=t,this.image=this.imagefilepath,this.mainAlpha=1,this.effects=[new A("logo-img-fadein",.01,1)],this.objImageOverlay=new y(this.name,this.x,this.y,this.left_or_right,this.top_or_bottom,this.image,this.mainAlpha,this.effects),this.objImageOverlay}CreateTickerOverlay(e,t,i,r,a){return this.name=e,this.tickertext=t,this.font="20px Arial",this.tickertextwidth=T.measureTextWidth(this.tickertext,this.font),this.tickertextheight=T.measureTextHeight(this.font),this.tickerobjectheight=this.tickertextheight+30,this.x=0,this.y=i.getFrameEndy()-this.tickerobjectheight,this.xspacing=0,this.yspacing=10,this.top_or_bottom=r,this.framestartx=i.defaultx,this.frameendx=i.getFrameEndx(),this.backcolor=new l({r:0,g:0,b:0,a:.2}),this.backgroundAlpha=.2,this.forecolor=new l({r:250,g:50,b:150,a:1}),this.foregroundAlpha=1,this.bordercolor=new l({r:250,g:250,b:250,a:1}),this.borderthickness=5,this.borderAlpha=.9,this.direction=a,this.speed=6,this.objTickerOverlay=new x(this.name,this.x,this.y,this.xspacing,this.yspacing,this.top_or_bottom,this.framestartx,this.frameendx,this.tickertextwidth,this.tickertextheight,this.backcolor,this.backgroundAlpha,this.forecolor,this.foregroundAlpha,this.bordercolor,this.borderthickness,this.borderAlpha,this.tickertext,this.font,this.direction,this.speed),this.objTickerOverlay}};class S{objhtml=new s.d;ShowOverlay(e,t){"tickeroverlay"==!t.type&&t.effects.push(new A("overlay-fadein",.01,.9)),t.overlays&&t.overlays.length>0&&t.overlays.forEach((e=>{e.effects.push(new A("TEXTFADEIN",.01,.9))})),e.overlays.push(t)}HideOverlay(e,t){let i=e.overlays.findIndex((e=>e.name===t));if((null!=i||-1!=i)&&e.overlays[i].effects){if("tickeroverlay"==e.overlays[i].type)return void e.overlays.splice(i,1);e.overlays[i].effects.push(new M("overlay-fadeout",.01,!0))}"overlays"in e.overlays[i]&&e.overlays[i].overlays.length>0&&e.overlays[i].overlays.forEach((e=>{e&&e.effects.push(new M("overlay-fadeout",.01,!0))}))}async ShowBackground(e,t){e.backgroundimg=await this.objhtml.createImageTag(t),e.backgroundeffects.push(new A("bg-fadein",.01,1))}async HideBackground(e){e.backgroundeffects.push(new M("bg-fadeout",.01,!1))}async CreateImageOverlay(e,t,i,r){let a=await this.objhtml.createImageTag(t);return C.CreateImageOverlay(e,a,i,r)}CreateTextOverlay(e,t,i,r,a){let o=C.CreateRectangleOverlay(e,t,i,r,a),n=C.CreateTextOverlay(e,o,t,i,r);return o.overlays.push(n),o}CreateTickerOverlay(e,t,i,r,a){return C.CreateTickerOverlay(e,t,i,r,a)}CreateRectangleOverlay(e,t,i,r,a){return C.CreateRectangleOverlay(e,t,i,r,a)}}class E{constructor(e,t){this.movespeed=t,this.name=e}move(e,t,i){var r=this.Difference(e,t),a=this.movespeed;return e||e>=0?(r<this.movespeed&&(a=r),e<t&&(e+=a),e>t&&(e-=a),e):(e=t,t||e||(t=0),e=0)}Difference(e,t){return t>e?t-e:e>t?e-t:0}CheckTargets(e,t,i){return Math.trunc(e)==Math.trunc(t)}CheckIteration(e,t){return e==t}}class V extends p{constructor(e,t=1,i=0,r=0,a=0,o=0){super(e),this.name=e,this.movespeed=t,this.type="movencropfx",this.AssignValues=e=>{this.initdone=!1,this.completed=!1,this.movespeed=e,this.x.current=0,this.y.current=0,i&&(this.x.current=i),r&&(this.y.current=r),this.w.current=0,this.h.current=0,a&&(this.w.current=a),o&&(this.h.current=o),this.videocropx.current=0,this.videocropy.current=0,this.videocropw.current=0,this.videocroph.current=0,this.x.target=0,this.y.target=0,this.w.target=0,this.h.target=0,this.videocropx.target=0,this.videocropy.target=0,this.videocropw.target=0,this.videocroph.target=0,this.xdone=!1,this.ydone=!1,this.wdone=!1,this.hdone=!1,this.cropxdone=!1,this.cropydone=!1,this.cropwdone=!1,this.crophdone=!1,this.mover=new E(this.name,this.movespeed)},this.AssignValues(t)}InitStart=()=>{0==this.initdone&&(this.initdone=!0)};beforeDraw=()=>{this.alldone()||(this.x.current=this.mover.move(Math.abs(this.x.current),Math.abs(this.x.target),this.xdone),this.y.current=this.mover.move(Math.abs(this.y.current),Math.abs(this.y.target),this.ydone),this.w.current=this.mover.move(Math.abs(this.w.current),Math.abs(this.w.target),this.wdone),this.h.current=this.mover.move(Math.abs(this.h.current),Math.abs(this.h.target),this.hdone),this.videocropx.current=this.mover.move(Math.abs(this.videocropx.current),Math.abs(this.videocropx.target),this.cropxdone),this.videocropy.current=this.mover.move(Math.abs(this.videocropy.current),Math.abs(this.videocropy.target),this.cropydone),this.videocropw.current=this.mover.move(Math.abs(this.videocropw.current),Math.abs(this.videocropw.target),this.cropwdone),this.videocroph.current=this.mover.move(Math.abs(this.videocroph.current),Math.abs(this.videocroph.target),this.crophdone))};FixNumber=e=>parseFloat(e);afterDraw=()=>{this.xdone=this.mover.CheckTargets(this.x.current,this.x.target,this.xdone),this.ydone=this.mover.CheckTargets(this.y.current,this.y.target,this.ydone),this.wdone=this.mover.CheckTargets(this.w.current,this.w.target,this.wdone),this.hdone=this.mover.CheckTargets(this.h.current,this.h.target,this.hdone),this.cropxdone=this.mover.CheckTargets(this.videocropx.current,this.videocropx.target,this.cropxdone),this.cropydone=this.mover.CheckTargets(this.videocropy.current,this.videocropy.target,this.cropydone),this.cropwdone=this.mover.CheckTargets(this.videocropw.current,this.videocropw.target,this.cropwdone),this.crophdone=this.mover.CheckTargets(this.videocroph.current,this.videocroph.target,this.crophdone),1==this.alldone()&&(this.initdone=!0,this.completed=!0)};alldone=()=>!!(this.xdone&&this.ydone&&this.wdone&&this.hdone&&this.cropxdone&&this.cropydone&&this.cropwdone&&this.crophdone)}class j{constructor(e,t,i,r,a,o,n=!1){this.name=e,this.scene=t,this.objLayout=new L(t),this.objUtil=new w.Z,1==n?(this.xgap=this.objUtil.getPercentageValue(a,t.getFrameWidth()),this.ygap=this.objUtil.getPercentageValue(o,t.getFrameHeight()),this.tilewidth=this.objUtil.getPercentageValue(i,t.getFrameEndx()-2*t.defaultx),this.tileheight=this.objUtil.getPercentageValue(r,t.getFrameHeight())):(this.tilewidth=i,this.tileheight=r,this.xgap=a,this.ygap=o)}getNextPosition(e,t,r,a,o,n){var s={};if(0==t.length)return{x:i.g.Global.defaultx,y:i.g.Global.defaulty,h:a,w:r};var c=e.x.target,d=e.y.target,l=e.w.target,h=e.h.target,u=e.scene.getFrameEndx(),p=e.scene.getFrameEndy(),g=d;if(c+r+r+o>u&&(g=d+h+n,c=this.scene.defaultx,l=0,o=0,g+a>p))throw console.log("full"),"Grid full";return s.x=c+l+o,s.y=g,s.h=a,s.w=r,s.xgap=o,s.ygap=n,s.y+a>e.scene.getFrameEndy()&&console.log(e.scene.getFrameHeight()+"GRID FULL. y + height goes beyond the bottom edge even when not overflowing ...y.current : "+d.toString()+" AND "+a.toString()),s}SetDefaultCrop(e){e.forEach((e=>{e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight}))}ReArrange(e=this.scene,t,i){this.SetDefaultCrop(t),t.length>0&&t.forEach((i=>{if(0==t.indexOf(i))i.x.target=e.defaultx,i.y.target=e.defaulty,i.w.target=this.tilewidth,i.h.target=this.tileheight;else{var r=this.getNextPosition(t[t.indexOf(i)-1],t,this.tilewidth,this.tileheight,this.xgap,this.ygap);i.x.target=r.x,i.y.target=r.y,i.w.target=r.w,i.h.target=r.h}}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new V("movencropfx from gridlayout",t))}))}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}}var $=new w.Z;class I{constructor(e,t,i){this.name=e,this.objScene=t,this.gapxpercent=i}ReArrange(e,t,i){this.mediaarray=t;let r=e.getFrameEndx()-e.defaultx,a=e.getFrameEndy()-e.defaulty,o=100/t.length,n=$.getPercentageValue(this.gapxpercent,r),s=$.getPercentageValue(o,r)-e.defaultx,c=a-e.defaulty,d=e.defaultx;t.forEach((e=>{let i=function(e,t){var i,r;r=e.videoheight,i=e.videowidth,console.log("source width height ",r,i);let a=$.getPercentageValue(50,i),o=t%2==0;console.log("centerxofvideo evenorodd ",a,o);let n=i/t,s=o?n:Math.round(n/2);console.log("piecewidth,movepoint",n,s);let c=a-s,d=c-n;return console.log("****************"),{videostartx:c,videoendx:d}}(e,t.length);e.x.target=Math.abs(d),e.y.target=Math.abs(this.objScene.defaulty),e.w.target=Math.abs(s),e.h.target=Math.abs(c),e.videocropx.target=Math.abs(i.videostartx),e.videocropw.target=Math.abs(i.videoendx),e.videocropy.target=0,e.videocroph.target=Math.abs(e.videoheight),d+=Math.abs(s)+Math.abs(n)}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new V("movencrop effect from column layout",t))}))}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}}var O=new w.Z;class N{constructor(e,t,i,r,a,o,n){this.name=e,this.mediaperrow=t,this.gapx=O.getPercentageValue(a,n.getFrameWidth()),this.gapy=O.getPercentageValue(o,n.getFrameHeight()),this.tileheight=O.getPercentageValue(i,n.getFrameHeight()),this.tilewidth=O.getPercentageValue(r,n.getFrameWidth()),this.objScene=n}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropy.current=e.videocropy.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new V("movencrop from centerlayout",t))}))}SetDefaultCrop(e){e.forEach((e=>{e.h.target=this.tileheight,e.w.target=this.tilewidth,e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight}))}ReArrange(e,t,i){this.ReCalculate(e,t)}ReCalculate(e,t){this.SetDefaultCrop(t),this.objScene=e,this.getCenterY=(e,t)=>O.getPercentageValue(50,e.getFrameHeight())-O.getPercentageValue(50,t.h.target),this.getCenterX=(e,t)=>{var i=0,r=e.getFrameEndx()-e.defaultx,a=O.getPercentageValue(50,r);return t.forEach((e=>{i+=e.w.target+this.gapx})),a-O.getPercentageValue(50,i)};var i,r,a=0,o=(i=t,r=this.mediaperrow,[...Array(Math.ceil(i.length/r))].map(((e,t)=>i.slice(r*t,r+r*t))));o.forEach((e=>{this.SetDefaultCrop(e);var t=this.getCenterX(this.objScene,e);a+=1;var i=0,r=0;e.forEach((n=>{if(i++,r=this.getCenterY(this.objScene,n),a>1){var s=o[o.indexOf(e)-1][i-1];r=s.y.target+s.h.target+this.gapy}else if(o.length>1){var c=o[o.indexOf(e)+1],d=c[i]?c[i-1]:c[c.length-1];r-=(d.h.target+this.gapy)*(o.length-1)/2}n.x.target=t,n.y.target=r,t+=n.w.target+this.gapx}))})),this.SetDefaultCrop(t)}}var D=new w.Z;class _{constructor(e,t,i,r,a,o){this.name=e,this.objScene=o,this.gapxpercent=t,this.gapypercent=i,this.mainvideowidthpercent=r,this.mainvideoheightpercent=a}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new V("movencropfx from CornerLayout",t))}))}ReArrange(e,t,i){this.objMainVideo=i,i||(this.objMainVideo=t[0]),this.objScene=e;var r=this.objScene.getFrameEndx()-this.objScene.defaultx,a=this.objScene.getFrameEndy()-this.objScene.defaulty,o=this.mainvideowidthpercent-this.gapxpercent,n=this.mainvideoheightpercent-this.gapypercent,s=100-o-this.gapxpercent,c=100-n-this.gapypercent,d=D.getPercentageValue(this.gapxpercent,r),l=D.getPercentageValue(this.gapypercent,a),h=(t.length,t.length,D.getPercentageValue(o,r)),u=D.getPercentageValue(n,a),p=this.objScene.defaultx,g=this.objScene.defaulty;let m=D.getPercentageValue(s,r)-d,f=D.getPercentageValue(c,a)-l,v=this.objScene.defaultx+h+d,y=this.objScene.defaulty+u+l;var x=this.objScene.defaultx,b=this.objScene.defaulty;this.objMainVideo.x.target=p,this.objMainVideo.y.target=g,this.objMainVideo.w.target=h,this.objMainVideo.h.target=u,this.objMainVideo.videocropx.target=0,this.objMainVideo.videocropy.target=0,this.objMainVideo.videocropw.target=i.realvideo.videoWidth,this.objMainVideo.videocroph.target=i.realvideo.videoHeight,t.forEach((e=>{e!=this.objMainVideo&&(e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight,e.x.target=v,e.y.target=b,b+=f+l,e.w.target=m,e.h.target=f,b+l>a&&(e.y.target=y,e.x.target=x,(x+=e.w.target+d)+m>r-m))&&console.log("CORNER LAYOUT grid full. Change the mainvideo's size to show all videos.Use a larger value for the mainvideo or reduce the number of videos")}))}}class P{constructor(e,t,i=!1){this.name=e,this.withoutborder=i,this.objScene=t}SetDefaultCrop(e){e.videocropx.target=0,e.videocropy.target=0,e.videocropw.target=e.realvideo.videoWidth,e.videocroph.target=e.realvideo.videoHeight}ReArrange(e=this.objScene,t,i){this.SetDefaultCrop(i),this.fullscreenvideo=i,this.objScene.bringToFront(this.fullscreenvideo),0==this.withoutborder?(i.x.target=this.objScene.defaultx,i.y.target=this.objScene.defaulty,i.w.target=this.objScene.getFrameWidth()-this.objScene.defaultx,i.h.target=this.objScene.getFrameHeight()-this.objScene.defaulty):(i.x.target=0,i.y.target=0,i.w.target=r.x.studioWidth,i.h.target=r.x.studioHeight)}ApplyTargets(e){e.forEach((e=>{e.x.current=e.x.target,e.y.current=e.y.target,e.h.current=e.h.target,e.w.current=e.w.target,e.videocropx.current=e.videocropx.target,e.videocropw.current=e.videocropw.target,e.videocroph.current=e.videocroph.target,e.videocropy.current=e.videocropy.target}))}ApplyAnimatedTargets(e,t){e.forEach((e=>{e.effects.push(new V("moveandcropfx from fullscreen layout",t))}))}}class L{selectedLayout(e,t){switch(e){case"center":this.Apply(new N("center layout1",3,50,33.33,0,0,t),t);break;case"corner":this.Apply(new _("corner layout1",1,2,75,75,t),t);break;case"3center":this.Apply(new N("3center",2,50,50,0,0,t),t);break;case"4grid":this.Apply(new _("full4grid",0,0,50,50,t),t);break;case"grid":default:this.Apply(new j("grid layout1",t,24,23,1.2,2.2,!0),t);break;case"column":this.Apply(new I("column layout1",t,1),t);break;case"fullscreen":this.Apply(new P("fullscreen layout",t,!1),t)}}Apply(e,t){e.ReArrange(t,t.allmedia,t.allmedia[0]),e.ApplyAnimatedTargets(t.allmedia,30)}}var R=new w.Z;let B=new S,W=new L;class U{objhtml=new s.d;videowidth=R.getPercentageValue(30,r.x.studioWidth);videoheight=R.getPercentageValue(30,r.x.studioHeight);async createMedia(e,t,i,a,o=null,n,s){let c;if("videofile"==t){const e=["FILES/videos/person3.mp4","FILES/videos/bigbuckbunnyhd.mp4","FILES/videos/person.mp4","FILES/videos/person1.mp4","FILES/videos/person2.mp4"];c=e[Math.floor(Math.random()*e.length)]}else c="No video"==i?"resources/videos/blank.mp4":i;let d=await this.objhtml.createMediaTag(e,t,c,a,200,"auto",o);if(!e)return d;d.addEventListener("resize",(e=>{console.log("^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^"),console.log(e.target.videoWidth+" : "+e.target.videoHeight)}));let l=new v(a,0,d,r.x.selectedSceneObj,r.x.selectedSceneObj.defaultx,r.x.selectedSceneObj.defaulty,d.videoWidth,d.videoHeight,!0);return l.bordercolor="white",console.log(l),r.x.selectedSceneObj.allmediacopy.push(l),null!=o&&(await l.overlays.push(B.CreateTextOverlay("medialabel_"+a,o,"left","top",{tl:10,br:10,tr:10,bl:10})),null!=n&&await l.overlays.push(B.CreateTextOverlay("medialabel_"+a,n,"left","bottom",{tl:10,br:10,tr:10,bl:10}))),l}async createAudio(e,t){return await this.objhtml.createAudioTag(e,t)}FlipMedia(e){r.x.selectedSceneObj.allmedia.find((t=>{t.mediabox.name===e&&(t.isMirrorVideo=!t.isMirrorVideo)}))}ShowMedia(e){let t=r.x.selectedSceneObj.allmediacopy.find((t=>t.mediabox.name===e));return r.x.selectedSceneObj.allmedia.push(t),r.x.scenes.forEach((e=>{e.sortmedia=[...e.allmedia]})),this.assignLayout(r.x.selectedSceneObj),t}HideMedia(e){let t=r.x.selectedSceneObj.sortmedia.findIndex((t=>t.mediabox.name===e)),i=r.x.selectedSceneObj.allmedia.findIndex((t=>t.mediabox.name===e));null==t&&-1==t||r.x.selectedSceneObj.sortmedia.splice(t,1),null==i&&-1==i||r.x.selectedSceneObj.allmedia.splice(i,1),this.assignLayout(r.x.selectedSceneObj)}RemoveMedia(e){let t=r.x.selectedSceneObj.allmediacopy.findIndex((t=>t.mediabox.name===e));null==t&&-1==t||r.x.selectedSceneObj.allmediacopy.splice(t,1)}assignLayout(e){return 1==e.allmedia.length?W.selectedLayout("fullscreen",e):2==e.allmedia.length||3==e.allmedia.length?W.selectedLayout("3center",e):4==e.allmedia.length?W.selectedLayout("4grid",e):e.allmedia.length>4&&e.allmedia.length<7?W.selectedLayout("center",e):e.allmedia.length>6&&e.allmedia.length<9?W.selectedLayout("corner",e):void 0}}let F=new L;class H{selectedLayout(e,t){F.selectedLayout(e,t)}}class z{scenewrapper=new c;mediawrapper=new U;layoutwrapper=new H;overlaywrapper=new S;CreateStudio(e){this.scenewrapper.CreateMainCanvas("MainCanvas"),this.scenewrapper.CreateScene(e),this.selectedsceneobj=this.scenewrapper.SelectedScene(e),this.scenewrapper.StartTimeline(this.selectedsceneobj)}}},596:(e,t,i)=>{i.d(t,{Z:()=>a});var r=i(541);function a(){this.ResizeImage=(e,t,i)=>{var r=document.createElement("canvas"),a=r.getContext("2d");return r.width=t,r.height=i,a.drawImage(e,0,0,t,i),r.toDataURL()},this.getRandom=function(e){return e[Math.floor(Math.random()*e.length)]},this.measureTextWidth=(e,t)=>(r.x.dummycanvasctx.font=t,r.x.dummycanvasctx.measureText(e).width),this.measureTextHeight=e=>(r.x.dummycanvasctx.font=e,parseInt(r.x.dummycanvasctx.font.match(/\d+/),15)),this.listenChangesinArray=function(e,t){["pop"].forEach((i=>{e[i]=function(){var r=Array.prototype[i].apply(e,arguments);return t.apply(e,arguments),r}}))},this.getPercentageValue=function(e,t){return t*(e/100)},this.getSizeMaintainingAspect=function(e,t,i,r){var a=Math.min(i/e,r/t);return{width:e*a,height:t*a}}}},871:(e,t,i)=>{i.d(t,{d:()=>a});var r=i(596);class a{constructor(){this.objUtil=new r.Z}createCanvasTag(e,t=1280,i=720,r){const a=document.createElement("CANVAS");return a.width=t,a.height=i,a.style.width="1px",a.style.height="1px",a.id=e,r&&jQuery("#Main").append(a),a}parseColor(e){const t=document.createElement("div");document.body.appendChild(t),t.style.color=e;const i=getComputedStyle(t).color.match(/[\.\d]+/g).map(Number);return t.remove(),i}async createVideoTag(e,t=0,i=0){var r=document.createElement("VIDEO");return r.width=t,r.height=i,r.src=e,await r.setAttribute("src",e),r.setAttribute("autoplay","autoplay"),r.setAttribute("loop","loop"),r.setAttribute("controls",""),r.setAttribute("playsinline",""),r.muted=!0,await r.load(),await r.play(),r}async createAudioTag(e,t){var i=document.createElement("AUDIO");return i.id="audio_"+e,i.autoplay=!0,"object"==typeof t?await this.setSource(i,t):(i.src=t,await i.setAttribute("src",t)),document.body.appendChild(i),i}async createImageTag(e,t=null,i=null){const r=document.createElement("img");return r.src=e,await r.decode(),null!=i&&null!=t&&(r.src=this.objUtil.ResizeImage(r,t,i)),r}createDivTag(e){var t=document.createElement("DIV");return t.id=e,t}async createMediaTag(e,t,i,r,a=0,o=0,n){let s,c=document.createElement("VIDEO");"object"==typeof i?await this.setSource(c,i):(c.src=i,await c.setAttribute("src",i)),c.setAttribute("autoplay","autoplay"),c.setAttribute("loop","loop"),c.classList.add("mirroron","videoBox");var d,l,h=n.replace(/([A-Z])/g," $1").trim();if(s=e?"Doctor":"Patient",c.setAttribute("id",t+"_"+r),c.setAttribute("playsinline",""),c.load(),"localstream"==t)var u='<div class="MainVideoBG" id="mainVideoBg"><div  class="mainVideo main-videoWrap" id="cardvideo_'+t+"_"+r+'"><div  class="main-Card card-img-overlay p-0  m-3"><span class="text-capitalize user-name px-3" ><div class="memberName text-truncate" title="'+h+'" ><i class="icon-user pe-1"></i>'+h+'</div><div class="memberDesignation d-flex px-1"><i class="icon-users"></i>'+s+'</div></span><div id="dropDown" class="dropdown float-end"><button class="btn btn-sm white-color dropdown-toggle pe-auto p-2" type="button" id="UserMenu" data-bs-toggle="dropdown"  aria-expanded="false" style="font-size: 1rem;"><i class="bi bi-three-dots-vertical"></i></button><ul id="Drop" class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu" style="padding: 0.2rem 0px;"><li onclick=toggleAudio(this,"'+r+'") ><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Start Audio</a></li><li onclick=toggleVideo(this,"'+r+'")><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a></li><li onclick=toggleFlip(this,"'+r+'")><a id="Dropdown_items"  class="dropdown-item" href="#"><i class="bi bi-symmetry-vertical m-1"></i>Flip</a></li></ul></div></div><div id="hostVideoOffWrap" class="hostVideoOff videoScreenOff w-100 h-100 position-absolute top-0 d-none hstack justify-content-center"><div class="videoOffTxt hostVideoOffTxt">'+h[0]+"</div></div></div></div>";else u=e?' <div id="ListVideos" class="video-list d-inline mb-lg-0 mb-0"><div class="SupportClass position-relative videoWrap" id="cardvideo_'+t+"_"+r+'"><div class="cardList card-img-overlay cardListOverlay "><span class="text-capitalize user-name px-3 text-break"><div class="memberName text-truncate" title="'+h+'"><i class="icon-user pe-1"></i>'+h+'</div></span> <div id="DropDown" class="dropdown float-end">  <button class="btn btn-sm white-color dropdown-toggle p-2" type="button" id="UserMenu" data-bs-toggle="dropdown"  aria-expanded="false" style="font-size: 1rem;" >   <i class="bi bi-three-dots-vertical"></i></button><ul id="Drop" class="dropdown-menu dropdown-menu-end" aria-labelledby="userMenu" style="padding: 0.2rem 0px;"><li onclick=toggleAudio(this,"'+r+'") ><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Start Audio</a></li><li onclick=toggleVideo(this,"'+r+'")><a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a></li></ul></div><div class="position-absolute bottom-0 end-0 mb-2 pb-1 VideoAudioToggle-Btns"><div class="videoTogglebutton" onclick="videoToggle(this, \''+r+'\')"><a class="videotoggleOn" href="#"><i class="bi bi-camera-video"></i></a></div><div class="audioToggleButton" onclick="audioToggle(this, \''+r+'\')"><a class="audioMute" href="#"><i class="bi bi-mic-mute m-2"></i></a></div></div></div><div class="participantVideoOff videoScreenOff w-100 h-100 position-absolute top-0 d-none hstack justify-content-center"><div class="videoOffTxt participantVideoOffTxt" title="'+h[0]+'">'+h[0]+"</div></div></div></div>":'<div  id="ListVideos" class="video-list d-inline  mb-lg-0 mb-0 "><div class="SupportClass position-relative videoWrap m-2" id="cardvideo_'+t+"_"+r+'"><div class="cardList card-img-overlay cardListOverlay"><span class="text-capitalize user-name px-3 text-break"><div class="memberName text-truncate" title="'+h+'" ><i class="icon-user pe-1"></i>'+h+'</div></span></div><div class="participantVideoOff videoScreenOff w-100 h-100 position-absolute top-0 d-none hstack justify-content-center"><div class="videoOffTxt participantVideoOffTxt" title="'+h[0]+'" >'+h[0]+"</div></div></div></div>";if(window.onmousemove=function(e){d=e.x,l=e.y},$((function(){"remotestream"==t&&$(".video-list").draggable({drag:function(e,t){var i=d-50,r=l-50,a=$(document).width(),o=$(document).height();t.position.left=Math.max(0,Math.min(i,a-$(this).width())),t.position.top=Math.max(0,Math.min(r,o-$(this).height())),t.position.right=a-t.position.left-$(this).width(),t.position.bottom=o-t.position.top-$(this).height(),$(this).css({position:"fixed",left:t.position.left,top:t.position.top,right:t.position.right,bottom:t.position.bottom})},stop:function(e,t){$(this)}})})),$((function(){if($("#ListVideos .videoWrap").length>0&&"remotestream"==t){var e=$(".video-list .videoWrap #"+t+"_"+r);e&&e.click()}})),$("#ListVideos .videoWrap").length>0&&"undefined"!=$("#ListVideos .videoWrap").attr("style")&&$("#ListVideos .videoWrap").removeAttr("style"),"localstream"==t){$("#VisualMedia").append(u);let e='<div id="ListVideosWrap" class="ListVideosWrap text-end  d-none" ></div>';$("#VisualMedia").append(e)}else $("#ListVideosWrap").removeClass("d-none"),$("#ListVideosWrap").append(u);return jQuery("#cardvideo_"+t+"_"+r).prepend(c),await c.load(),await c.play(),c}async setSource(e,t){e.srcObject=t}}},112:(e,t,i)=>{i.d(t,{x:()=>r});class r{static Peers=new Array;static allAudioTracks=new Array;static mainAudioTrack;static silenceAudioTrack;static socketclient;static socketid;static localmediastream;static localMediaVideoStream;static localMediaAudioStream;static localVisualMedia;static capturestream=null;static AudioMix=new Event("onAudioMix");static conferencename;static userid;static isadmin;static displayname;static videorecording;static audiorecording;static StreamAudioContext;static newBrowserTab;static data;static getdata(){return this.data={conferencename:this.conferencename,userid:this.userid,isadmin:this.isadmin,displayname:this.displayname,videorecording:this.videorecording,audiorecording:this.audiorecording,newBrowserTab:this.newBrowserTab}}static videoInput=new Array;static audioInput=new Array;static audioOutput=new Array;static Constraints={audio:!1,video:!1};static isCameraAvailable=!1;static isMicAvailable=!1}},126:(e,t,i)=>{function r(e){this.turn="turn:"+window.location.hostname+":3479",this.configuration={iceServers:[{urls:this.turn,credential:"livebox123",username:"livebox"}]},this.peer=new RTCPeerConnection(this.configuration),this.peerid=e,this.socketid,this.audiotrack,this.videotrack,this.videomediastream,this.audiomediastream,this.displayname,this.VisualMedia,this.showonstream}i.d(t,{_:()=>r})},94:(e,t,i)=>{i.d(t,{N:()=>d,T:()=>l});var r=i(126),a=i(112),o=i(513);i(541),new o.N;var n,s,c=0;function d(){(s=a.x.getdata()).peerid=a.x.socketclient.id,n?n.peer.close():(n=new r._(s.peerid),a.x.capturestream||(a.x.capturestream=document.getElementById("MainCanvas").captureStream(30)),a.x.capturestream.addTrack(a.x.mainAudioTrack),a.x.capturestream.getTracks().forEach((e=>{console.log(e.getSettings()),console.log(e.getConstraints()),n.peer.addTrack(e,a.x.capturestream)})),n.peer.createOffer().then((e=>n.peer.setLocalDescription(e))).catch(h),n.peer.oniceconnectionstatechange=e=>console.log(n.peer.iceConnectionState),n.peer.onicecandidate=e=>{if(1==(c+=1)){let e=btoa(JSON.stringify(n.peer.localDescription));s.offer=e,a.x.socketclient.emit("sendofferforstreaming",s)}},a.x.socketclient.on("receiveanswerforstreaming",(function(e){try{n.peer.setRemoteDescription(new RTCSessionDescription(JSON.parse(atob(e))));let t=n.peer.getSenders().find((function(e){return"video"==e.track.kind}));const i=t.getParameters();console.log(i.degradationPreference),i.degradationPreference="maintain-resolution",t.setParameters(i),console.log("Streaming started . . ."),setTimeout((()=>{if(s.isadmin)if(notification("Started to record..","success"),$("#conferencetimer").removeClass("d-none"),$("#RecordingSymbol").addClass("recordSymbol"),$("#conferencetimer").addClass("RecordTextAdding"),s.videorecording){$("#conferencetimer").removeClass("d-none");var e='<p id="recordingText" style="color: #b7b7b7; font-size: 1rem;">Video Recording</p>';$("#clockdiv .RecordText").append(e)}else s.audiorecording&&(e='<p id="recordingText" style="color: #b7b7b7; font-size: 1rem;">Audio Recording</p>',$("#clockdiv .RecordText").append(e))}),2e3)}catch(e){console.log(e)}})))}function l(){s&&(s.channelLink=window.location.href.split("?")[0]+"recordedvideos/"+s.conferencename+"/",console.log("ObjVideoLink",s.channelLink),a.x.socketclient.emit("stopstreaming",s),setTimeout((()=>{n&&n.peer.close(),n=null}),6e3),notification("Recording stopped.","success"))}function h(e){}window.addEventListener("onAudioMix",(e=>{!function(){if(n){let e=n.peer.getSenders().find((function(e){return"audio"==e.track.kind}));e&&e.replaceTrack(a.x.mainAudioTrack)}}()}))},679:(e,t,i)=>{i.d(t,{E:()=>x});var r=i(112),a=i(126),o=i(513);let n=new o.N;class s{VideoSourceType={type1:"localstream",type2:"remotestream",type3:"videofile",type4:"screenshare",type5:"videolink"};VideoResolutions=[{value:"720p",name:"High Definition (720p)",width:1280,height:720},{value:"480p",name:"Standard Definition (480p)",width:320,height:240},{value:"360p",name:"Low Definition (360)",width:480,height:360}];initializeCamera(e){self=this;try{this.getConnectedMediaDevices((function(){self.getCamera((function(t){self.getMic((function(t){notification("Intialized camera !","success"),e()}))}))}))}catch(t){notification(t,"failure"),e(t)}}getCamera(e){self=this,r.x.Constraints.video?self.getUserMedia("video",(function(t){t?(r.x.isCameraAvailable=!0,r.x.localMediaVideoStream=t,self.setup_local_media_preview(t,"preview"),e(r.x.isCameraAvailable)):(r.x.isCameraAvailable=!1,notification("Camera is not available","failure"),e(r.x.isCameraAvailable))})):(r.x.isCameraAvailable=!1,notification("Camera is not available","failure"),e(r.x.isCameraAvailable))}getMic(e){self=this,r.x.Constraints.audio?self.getUserMedia("audio",(function(t){t?(r.x.isMicAvailable=!0,r.x.localMediaAudioStream=t,e(r.x.isMicAvailable)):(r.x.isMicAvailable=!1,notification("Mic is not available","failure"),e(r.x.isMicAvailable))})):(r.x.isMicAvailable=!1,notification("Mic is not available","failure"),e(r.x.isMicAvailable))}getUserMedia(e,t){navigator.mediaDevices.getUserMedia(r.x.Constraints[e]).then((function(e){t(e)})).catch((function(e){console.log(e.name),"NotFoundError"==e.name||"DevicesNotFoundError"==e.name?notification("required track is missing ","","failure"):"NotReadableError"==e.name||"TrackStartError"==e.name?notification("webcam or mic are already in use  ","","failure"):"OverconstrainedError"==e.name||"ConstraintNotSatisfiedError"==e.name?notification("constraints can not be satisfied by avb. devices  ","","failure"):"NotAllowedError"==e.name||"PermissionDeniedError"==e.name?notification("permission denied in browser  ","","failure"):"TypeError"==e.name||"TypeError"==e.name?notification("empty constraints object  ","","failure"):notification("other errors  ","","failure"),t(!1)}))}stopTracks(e){"video"==e?r.x.localMediaVideoStream&&r.x.localMediaVideoStream.getTracks().forEach((function(e){e.stop()})):r.x.localMediaAudioStream&&r.x.localMediaAudioStream.getTracks().forEach((function(e){e.stop()}))}getConnectedMediaDevices(e){navigator.mediaDevices.enumerateDevices().then((t=>{r.x.videoInput=t.filter((e=>"videoinput"===e.kind)),r.x.audioInput=t.filter((e=>"audioinput"===e.kind)),r.x.audioOutput=t.filter((e=>"audiooutput"===e.kind)),r.x.videoInput.length>0?r.x.Constraints.video={video:{width:{max:1920,min:640},height:{max:1080,min:360},aspectRatio:{exact:1.7777777778}}}:r.x.Constraints.video=!1,r.x.audioInput.length>0?r.x.Constraints.audio={audio:!0}:r.x.Constraints.audio=!1,e()}))}toggleMic(e){self=this;let t=r.x.localMediaAudioStream;r.x.isMicAvailable&&null!=t&&t.active&&t.getAudioTracks().length>0?t.getAudioTracks().forEach(((i,r)=>{t.getAudioTracks()[r].enabled=!t.getAudioTracks()[r].enabled,e(t.getAudioTracks()[r].enabled?"Unute":"Mute")})):self.getMic((function(t){if(t){let t=r.x.localMediaAudioStream;r.x.isMicAvailable&&null!=t&&t.active&&t.getAudioTracks().length>0&&t.getAudioTracks().forEach(((i,r)=>{t.getAudioTracks()[r].enabled=!t.getAudioTracks()[r].enabled,e(t.getAudioTracks()[r].enabled?"Unute":"Mute")}))}else e(!1)}))}toggleVideo(e){self=this;let t=r.x.localMediaVideoStream;r.x.isCameraAvailable&&null!=t&&t.active&&t.getVideoTracks().length>0?t.getVideoTracks().forEach(((i,a)=>{t.getVideoTracks()[a].enabled=!t.getVideoTracks()[a].enabled,e(t.getVideoTracks()[a].enabled?"Start cam":"Stop cam"),$("#localstream_"+r.x.socketclient.id)[0].nextSibling.firstChild;var o=$("#localstream_"+r.x.socketclient.id)[0],n="#"+$("#localstream_"+r.x.socketclient.id).parent().attr("id"),s=o.parentNode;console.log(t.getVideoTracks()[a]),0==t.getVideoTracks()[a].enabled?(s.classList.add("videoMuted"),$(n).find(".videoScreenOff").toggleClass("d-none"),$(".video-list .videoWrap").length>0&&($("#localstream_"+r.x.socketclient.id)[0].parentNode.className==$(".video-list .videoWrap")[0].className&&console.log("video off conditionBlk within"),console.log("video off conditionBlk"))):($(n).find(".videoScreenOff").addClass("d-none"),s.classList.remove("videoMuted"))})):this.getCamera((function(t){if(t){let t=r.x.localMediaVideoStream;r.x.isCameraAvailable&&null!=t&&t.active&&t.getVideoTracks().length>0&&t.getVideoTracks().forEach(((i,r)=>{t.getVideoTracks()[r].enabled=!t.getVideoTracks()[r].enabled,e(t.getVideoTracks()[r].enabled?"Start cam":"Stop cam")}))}else e(!1)}))}changeCamera(e){this.stopTracks("video"),this.getCamera((function(t){e(!!t&&r.x.localMediaVideoStream)}))}changeMic(e){this.stopTracks("audio"),this.getMic((function(t){e(!!t&&r.x.localMediaAudioStream)}))}getAudioStream(e){let t,i=e.getAudioTracks();return t=i.length>0?new MediaStream(i):"No Audio",t}getVideoStream(e){let t,i=e.getVideoTracks();return t=i.length>0?new MediaStream(i):"No video",t}getAudioTrack(e){let t=e.getAudioTracks();return t.length>0?t:"No audio"}getVideoTrack(e){let t=e.getVideoTracks();return t.length>0?t:"No video"}addAudioTrack(e,t){t&&(r.x.allAudioTracks.push({id:e,audiotrack:t}),r.x.mainAudioTrack=this.MixallAudioTracks(r.x.allAudioTracks),console.log("ON add Audio track**********************************************************",e,r.x.allAudioTracks),this.dispatchAudioChangeEvent())}removeAudioTrack(e){let t=r.x.allAudioTracks.findIndex((t=>t.id===e));null==t&&-1==t||(r.x.allAudioTracks.splice(t,1),r.x.mainAudioTrack=this.MixallAudioTracks(r.x.allAudioTracks),console.log("ON remove Audio track**********************************************************",e,r.x.allAudioTracks),this.dispatchAudioChangeEvent())}dispatchAudioChangeEvent(){window.dispatchEvent(r.x.AudioMix)}MixallAudioTracks(e){let t=new AudioContext;if(e.length>0){let i=e.map((e=>t.createMediaStreamSource(new MediaStream([e.audiotrack])))),a=t.createMediaStreamDestination();return i.forEach((e=>e.connect(a))),r.x.StreamAudioContext=t,a.stream.getAudioTracks()[0]}return r.x.silenceAudioTrack}silenceAudio=()=>{let e=new AudioContext,t=e.createOscillator(),i=t.connect(e.createMediaStreamDestination());return t.start(),Object.assign(i.stream.getAudioTracks()[0],{enabled:!1})};async setupLocalVideo(e){try{let t=r.x.localMediaVideoStream;t&&(r.x.localVisualMedia?r.x.isadmin?r.x.localVisualMedia.mediabox.realvideo.srcObject=t:r.x.localVisualMedia.srcObject=t:r.x.localVisualMedia=await n.mediawrapper.createMedia(r.x.isadmin,this.VideoSourceType.type1,t,r.x.socketclient.id,r.x.displayname,r.x.conferencename,r.x.recording)),e()}catch(e){}}setup_local_media_preview(e,t){$("#"+t)[0].srcObject=e}async setupRemoteVideo(e,t,i){i(await n.mediawrapper.createMedia(e,this.VideoSourceType.type2,t.videomediastream,t.peerid,t.displayname))}async setupRemoteAudio(e,t){await n.mediawrapper.createAudio(e,t)}setupRemoteCanvasVideo(e){let t=document.createElement("VIDEO");t.id="mainvideo",t.style.width="100%",t.setAttribute("autoplay","autoplay"),t.setAttribute("loop","loop"),t.setAttribute("playsinline",""),t.srcObject=e,t.load(),t.play(),$("#Main").empty().append(t)}}let c=new o.N,d=new s;class l{addPeer(e){if(console.log(" My Socket id :",r.x.socketclient.id),e.peerid!=r.x.socketclient.id){let i=e.peerid;if(console.log("Signaling server said to add peer:",i," to Create offer :",e.createoffer),r.x.Peers.find((e=>e.peerid===i)))return void console.log("Already connected to peer ",i);var t=new a._(i);t.isadmin=e.isadmin,t.displayname=e.displayname,r.x.Peers.push(t),t.peer.onicecandidate=e=>{if(e.candidate){let t={peerid:i,type:"candidate",roomname:r.x.conferencename,data:e.candidate};this.sendSDPdescription("senddata",t)}},t.peer.onnegotiationneeded=r=>{console.log("ON NEGOTIATION NEEDED"),e.createoffer&&this.createoffer(t,i)},t.peer.ontrack=e=>{e.streams[0]&&("video"==e.track.kind&&(console.log("VIDEO : :  :  : ",e.track,e.streams[0]),console.log(e.track.getConstraints()),this.setupRemoteVideo(i,e.streams[0])),"audio"==e.track.kind&&(console.log("AUDIO : :  :  : ",e.track,e.streams[0]),this.setupRemoteAudio(i,e.track,e.streams[0])))},r.x.localMediaVideoStream.getVideoTracks().forEach((e=>{t.peer.addTrack(e,r.x.localMediaVideoStream)})),r.x.localMediaAudioStream.getAudioTracks().forEach((e=>{t.peer.addTrack(e,r.x.localMediaAudioStream)}))}}createoffer(e,t){self=this,console.log("Creating RTC offer to ",t),e.peer.createOffer((function(i){e.peer.setLocalDescription(i,(function(){let e={peerid:t,type:"offer",roomname:r.x.conferencename,data:i};self.sendSDPdescription("senddata",e)}),(function(){Alert("Offer setLocalDescription failed!")}))}),(function(e){console.log("Error sending offer: ",e)}))}onOffer(e){let t=e.peerid,i=r.x.Peers.find((e=>e.peerid===t));i.peer.setRemoteDescription(new RTCSessionDescription(e.data)),i.peer.createAnswer().then((e=>{i.peer.setLocalDescription(e);let a={peerid:t,type:"answer",data:e,roomname:r.x.conferencename};this.sendSDPdescription("senddata",a)})).catch()}onAnswer(e){try{let t=e.peerid;r.x.Peers.find((e=>e.peerid===t)).peer.setRemoteDescription(new RTCSessionDescription(e.data))}catch(e){console.error("Error on answer",e)}}onCandidate(e){try{var t=e.peerid;r.x.Peers.find((e=>e.peerid===t)).peer.addIceCandidate(e.data)}catch(e){console.error("Error adding received ice candidate",e)}}async onRemovePeer(e){if(e){let t=r.x.Peers.findIndex((t=>t.peerid===e));if(-1!=t){let i=r.x.Peers[t].peer;await i.close(),this.removeElement("cardvideo_remotestream_"+e),this.removeElement("audio_"+e),d.removeAudioTrack(e),r.x.Peers.splice(t,1),r.x.isadmin&&(c.mediawrapper.HideMedia(e),c.mediawrapper.RemoveMedia(e))}}}removeElement(e){$("#"+e).remove(),this.videoRemoved()}videoRemoved(){if($(".video-list .videoWrap").length>0&&"undefined"!=$(".video-list .videoWrap").attr("style")&&($("#ListVideos .videoWrap").removeAttr("style"),$("#ListVideos").removeAttr("style")),0==$(".mainVideo").length&&$(".video-list .videoWrap").length>0){var e=$("#localstream_"+r.x.socketclient.id);$("#mainVideoBg").each((async function(){$("#mainVideoBg").html(' <div class="mainVideo main-videoWrap"> </div>'),await $("#mainVideoBg .mainVideo").append(e[0].offsetParent),e[0].style.width="100%",$("#mainVideoBg .SupportClass").removeClass("position-relative videoWrap"),$("#mainVideoBg .cardList").removeClass("p-0 p-sm-1"),$("#mainVideoBg .SupportClass").addClass("mb-0").removeClass("m-2"),$("#mainVideoBg .cardList").addClass("main-Card position-absolute top-0 start-0"),$("#mainVideoBg .main-Card").removeClass("cardList"),$("#mainVideoBg .main-Card").removeClass("cardListOverlay");var t=$("#mainVideoBg .SupportClass .participantvideooff");t.attr("id","hostVideoOffWrap"),t.removeClass("participantVideoOff").addClass("hostVideoOff"),e&&$("#mainVideoBg .VideoAudioToggle-Btns").remove()}))}}sendSDPdescription(e,t){r.x.socketclient.emit(e,t)}getPeerObjbyPeerId(e){return r.x.Peers.find((t=>t.peerid===e))}AudioTrackEnableDisable(e,t){var i=r.x.Peers.find((t=>t.peerid===e));if(i){i.showonstream=t;let e=i.peer.getReceivers().find((function(e){return"audio"==e.track.kind}));e&&(e.track.enabled=t)}}setupRemoteVideo(e,t){let i=r.x.Peers.find((t=>t.peerid===e));i.videomediastream=t,d.setupRemoteVideo(r.x.isadmin,i,(function(t){i.VisualMedia=t,r.x.isadmin&&c.mediawrapper.ShowMedia(e)}))}setupRemoteAudio(e,t,i){r.x.Peers.find((t=>t.peerid===e)).audiomediastream=i,d.setupRemoteAudio(e,i),t&&r.x.isadmin&&d.addAudioTrack(e,t)}getRemotePeerAudioTrack(e){let t=this.getPeerObjbyPeerId(e);return!!t.audiomediastream&&t.audiomediastream.getAudioTracks()[0]}getRemotePeerVideoTrack(e){let t=this.getPeerObjbyPeerId(e);return!!t.videomediastream&&t.videomediastream.getVideoTracks()[0]}ShowOrHideStream(e,t,i){let a;switch(t){case"remotestream":a=this.getRemotePeerAudioTrack(i);break;case"localstream":r.x.localMediaAudioStream&&(a=r.x.localMediaAudioStream.getAudioTracks()[0])}a&&d.addAudioTrack(i,a);let o={};return o.showonstream=e,o.id=i,o.conferencename=r.x.conferencename,r.x.socketclient.emit("sendAudio",o),o}FlipMedia(e){c.mediawrapper.FlipMedia(e)}toggleAudio(e){let t=this.getPeerObjbyPeerId(e);if(t){let e=t.peer.getReceivers().find((function(e){return"audio"==e.track.kind}));return!!e&&e.track.enabled}return!1}toggleVideo(e){let t=this.getPeerObjbyPeerId(e);if(t){let e=t.peer.getReceivers().find((function(e){return"video"==e.track.kind}));return!!e&&(e.track.enabled=!e.track.enabled,e.track.enabled)}return!1}replaceVideoTrack(){let e=r.x.localMediaVideoStream.getVideoTracks()[0];r.x.Peers.forEach((function(t){let i=t.peer.getSenders().find((function(t){return t.track.kind==e.kind}));console.log("found sender:",i),i.replaceTrack(e)}))}replaceAudioTrack(){let e=r.x.localMediaAudioStream.getAudioTracks()[0];r.x.Peers.forEach((function(t){let i=t.peer.getSenders().find((function(t){return t.track.kind==e.kind}));console.log("found sender:",i),i.replaceTrack(e)}))}}var h=i(94);let u,p=new l,g=[];class m{initializeSocketEvents(e){self=this,r.x.socketclient=io(),r.x.socketclient.on("connect",(function(){console.log("Connected to signaling server"),e("Connected"),$("#connectionBlk").addClass("d-none"),$("#streamingVideoBlk").removeClass("d-none")})),r.x.socketclient.on("addPeer",(function(e){p.addPeer(e)})),r.x.socketclient.on("message",(function(e){switch(e.type){case"offer":p.onOffer(e);break;case"answer":p.onAnswer(e);break;case"candidate":p.onCandidate(e)}})),r.x.socketclient.on("removePeer",(function(e){p.onRemovePeer(e)})),r.x.socketclient.on("receiveAudio",(function(e){p.AudioTrackEnableDisable(e.id,e.showonstream)})),r.x.socketclient.on("receiveChat",(function(e){!function(e){console.log("Type",e);var t=document.createElement("li");notification("Message from "+e.username),$("#chatNotification").removeClass("d-none"),t.innerHTML=`\n<div class="d-flex flex-row justify-content-end">\n    <div class="participantMsg pe-4 w-100">\n\t<div class="d-flex justify-content-end">\n\t  <p class="small participantName mb-1">${e.username}</p>\n          <p class="small d-none mb-1 text-muted">${$.format.date(new Date,"h:mm a")}</p>\n\t</div>\n        <p class="p-2 my-2 text-break text-left participantReplyMsgTxt" style="text-align: initial;">${e.text}</p>\n    </div>\n    <div class="logo-box text-center rounded-2 flex-shrink-0">\n    <div class="avatar  d-flex justify-content-center align-items-center UserReciveMessage">\n        <span class="avatar-initial h4 text-white text-uppercase">\n            ${e.username.charAt(0).toUpperCase()}\n        </span>\n    </div>\n    </div>\n</div>`,messages.appendChild(t)}(e)})),r.x.socketclient.on("acceptordecline",(function(e){var t;r.x.isadmin&&(t=e,f.innerHTML="",t.length>0?t.forEach((function(e){if(e.conferencename==r.x.conferencename){$("#participantsNotification").removeClass("d-none"),notification("Join request from "+e.displayname,"success"),$(document).ready((function(){$("#modalParticipants").modal("show"),$("#participantsNotification").show(),$(".modal-backdrop").show()})),$("#modalParticipants").on("click",(function(){$("#modalParticipants").modal("toggle")}));var t=e.displayname.replace(/([A-Z])/g," $1").trim();f.innerHTML+="<div class='d-flex align-items-center justify-content-between my-3 text-center'><span class='d-inline-block text-truncate my-0 me-2 pb-0 popupUsername' title='"+t+"'>"+t+"</span><div class='d-flex justify-content-evenly'> <button type='button' id='reject' class='reject btn btn-light me-2 col-4' onclick='rejectUser(this,"+JSON.stringify(e)+");'>REJECT</button><button type='button' id='accept' class='col-4 btn btn-light accept col-2' onclick='acceptUser(this,"+JSON.stringify(e)+");'>ACCEPT</button></div></div>"}})):f.innerHTML='<div class="text-center">No users</div>')})),r.x.socketclient.on("Accepted",(function(e){document.getElementById("load").style.display="none",document.getElementById("Main").style.display="block",r.x.socketclient.emit("joinConference",e)})),r.x.socketclient.on("sendrequestresponse",(function(e){e.forEach((function(e){if(e.conferencename===r.x.conferencename){var t='<div class="mb-2  "><span class="avatar avatar-24 bg-danger text-white  rounded-circle  m-2 ">'+e.displayname.substring(0,1)+'</span><span class="">'+e.displayname+" </span></div>";$("#listdisplayname").append(t)}}))})),r.x.socketclient.on("Rejected",(function(e){document.getElementById("load").innerHTML="Sorry, Admin rejected your request"})),r.x.socketclient.on("onremoveguestuser",(function(e){location.replace(window.location.href.split("?")[0]+"conferenceended.html")})),r.x.socketclient.on("ontoggleAudio",(function(){$("#idAudio").click()})),r.x.socketclient.on("ontoggleVideo",(function(){$("#idVideo").click()})),r.x.socketclient.on("toggleFlipres",(function(e){console.log("flip data",e);let t=document.getElementById("remotestream_"+e.peerid);t&&(t.classList.toggle("mirroron"),r.x.isadmin&&p.FlipMedia(e.peerid))})),r.x.socketclient.on("muteallres",(function(){if(console.log("clicked muteall button"),!r.x.isadmin){let e=r.x.localMediaAudioStream;null!=e&&e.getAudioTracks().length>0&&e.getAudioTracks().forEach(((t,i)=>{e.getAudioTracks()[i].enabled&&(notification("Admin muted your mic","info"),$("#idAudio").click())}))}})),r.x.socketclient.on("removeAcceptedUserEvent",(function(e){0!=$("#accept").length&&$("#accept")[0].parentNode.parentNode.remove(),console.log($("#accept")[0]),console.dir($("#accept")[0]),0==$("#acceptdeclineid").children().length&&(f.innerHTML='<div class="text-center">No users</div>')})),r.x.socketclient.on("removeRejectedUsersEvent",(function(e){0!=$("#reject").length&&$("#reject")[0].parentNode.parentNode.remove(),0==$("#acceptdeclineid").children().length&&(f.innerHTML='<div class="text-center">No users</div>')})),r.x.socketclient.on("StratStreaming",(function(e){console.log("startStreaming"),(0,h.N)()})),r.x.socketclient.on("RestartRecording",(function(e){console.log("Restart Streaming",e),(0,h.N)()})),r.x.socketclient.on("showVoiceToText",(function(e,t){g=[],""!==t.trim()?(g.push(t),function(e,t){$("#caption-wrapper").removeClass("intellaTextwrapper").css("display","inline-block").addClass("TranscriptionCaption-wrapper"),$("#caption-wrapper, .participant-speaker").css("display","inline-block"),$("#caption-wrapper .participantspeaker-name").text(e.displayname),$("#caption-wrapper .participantspeaker-text").text(t),$("#TestingBeta-text").css("display","inline-block").addClass("d-flex")}(e,g.join("")),clearTimeout(u),u=setTimeout(v,1e4)):v()})),r.x.socketclient.on("RemoveRecordText",(function(){$("#RecordingSymbol").removeClass("recordSymbol"),$("#conferencetimer").removeClass("RecordTextAdding"),$("#recordingText").remove()})),r.x.socketclient.on("AddingRecoingTextForUser",(function(e){setTimeout((()=>{if($("#conferencetimer").removeClass("d-none"),$("#RecordingSymbol").addClass("recordSymbol"),$("#conferencetimer").addClass("RecordTextAdding"),e.videorecording&&0===$("#recordingText").length){var t='<p id="recordingText" style=" color: #b7b7b7; font-size: 1rem;">Video Recording</p>';$("#clockdiv .RecordText").html(t)}else e.audiorecording&&0===$("#recordingText").length&&(t='<p id="recordingText" style="color: #b7b7b7; font-size: 1rem;">Audio Recording</p>',$("#clockdiv .RecordText").append(t))}),3e3)})),navigator.userAgent.match(/Android|iPhone|iPad|iPod/i)&&r.x.socketclient.on("endConferenceforeveryoneres",(function(){location.replace(window.location.href.split("?")[0]+"conferenceended.html")}))}socketEmit(e,t){r.x.socketclient.emit(e,t)}}const f=document.getElementById("acceptdeclineid");function v(){g=[],$("#caption-wrapper").removeClass("TranscriptionCaption-wrapper").css("display","none").addClass("intellaTextwrapper"),$("#caption-wrapper, .participant-speaker").css("display","none"),$("#caption-wrapper .participantspeaker-text").text(""),$("#caption-wrapper .participantspeaker-name").text(""),$("#caption-wrapper .participantspeaker-text").text(""),$("#TestingBeta-text").css("display","inline-block").removeClass("d-flex")}window.acceptUser=(e,t)=>{console.log(t),r.x.socketclient.emit("userAccepted",t)},window.rejectUser=(e,t)=>{console.log(t),r.x.socketclient.emit("userRejected",t)};let y=new class{Studio=new o.N;InitStudio(e){this.Studio.CreateStudio(e)}};class x{objSocketManager=new m;objMediaCapture=new s;objPeerManager=new l;joinConference(e,t){let i=this;i.objSocketManager.initializeSocketEvents((function(a){i.setGlobalVariables(e),i.objMediaCapture.initializeCamera((function(a){e.isadmin&&y.InitStudio("scene1"),i.objMediaCapture.setupLocalVideo((function(){e.isadmin?(console.log("newBrowsertabClicked",e.newBrowserTab),(e.videorecording||e.audiorecording)&&(e.channelLink=window.location.href.split("?")[0]+"recordedvideos/"+e.conferencename+"/"),i.objSocketManager.socketEmit("joinConference",e),r.x.localMediaAudioStream?i.objMediaCapture.addAudioTrack(r.x.socketclient.id,r.x.localMediaAudioStream.getAudioTracks()[0]):(i.setSilenceAudioTrack(),i.objMediaCapture.addAudioTrack(r.x.socketclient.id,r.x.silenceAudioTrack)),y.Studio.mediawrapper.ShowMedia(r.x.socketclient.id)):(console.log("newBrowsertabClicked",e.newBrowserTab),i.objSocketManager.socketEmit("sendrequest",e)),t()}))}))}))}leaveConference(e){this.objSocketManager.socketEmit("leaveConference",e)}setGlobalVariables(e){r.x.conferencename=e.conferencename,r.x.userid=e.userid,r.x.isadmin=e.isadmin,r.x.videorecording=e.videorecording,r.x.audiorecording=e.audiorecording,r.x.displayname=e.displayname.charAt(0).toUpperCase()+e.displayname.slice(1),r.x.newBrowserTab=e.newBrowserTab}setSilenceAudioTrack(){r.x.silenceAudioTrack=this.objMediaCapture.silenceAudio()}}},328:(e,t,i)=>{i.d(t,{X:()=>g});var r=i(112);class a{static audioBufferToWav(e,t){const i=t[0].length*t.length,r=new ArrayBuffer(44+2*i),a=new DataView(r),o=(e,t,i)=>{for(let r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))};o(a,0,"RIFF"),a.setUint32(4,36+2*i,!0),o(a,8,"WAVE"),o(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,t.length,!0),a.setUint32(24,e,!0),a.setUint32(28,4*e,!0),a.setUint16(32,2*t.length,!0),a.setUint16(34,16,!0),o(a,36,"data"),a.setUint32(40,2*i,!0);let n=44;for(let e=0;e<t[0].length;e++)for(let i=0;i<t.length;i++){const r=Math.max(-1,Math.min(1,t[i][e]));a.setInt16(n,r<0?32768*r:32767*r,!0),n+=2}return r}}let o,n,s,c,d,l,h,u=[];async function p(){try{let e={mimeType:"audio/webm;codecs=opus"};const t=new MediaRecorder(r.x.localMediaAudioStream,e),i=[];t.addEventListener("dataavailable",(async e=>{e.data.size>0&&i.push(e.data)})),t.addEventListener("stop",(async()=>{const e=new Blob(i),t=await e.arrayBuffer(),o=void 0===r.x.StreamAudioContext?new AudioContext:r.x.StreamAudioContext,c=await o.decodeAudioData(t),d=a.audioBufferToWav(c.sampleRate,[c.getChannelData(0)]),l=new Blob([d],{type:"audio/wav"}),h=await m(l);if(s){const e=JSON.stringify({recordingId:s,data:h});n.emit("recording-chunk",e)}})),t.start(),o=setTimeout((()=>{t.stop(),p()}),3e3)}catch(e){console.error("Error",e)}}function g(){if(s){clearInterval(o);const e=JSON.stringify({api_token:c,accountId:d,recordingId:s});n.emit("stop-recording",e),s=""}}$(window).on("load",(()=>{$("#idCaption").on("click",(e=>{var t;e.preventDefault(),$("#idAudio").hasClass("flaticon-microphone")?$("#idCaption").hasClass("flaticon-subtitles")?(t=p,c="NuAnK1TalE+VPkcyvlG7ww==",d="e203026f-1f6a-4935-901c-85f3eac4cee1",n=io("wss://ws.intella.me",{path:"/sockets",transports:["websocket"],auth:{api_token:c,accountId:d}}),n.on("recording-started",(e=>{s=JSON.parse(e).recordingId})),n.on("connect",(()=>{console.log("speech socket Connected ")})),n.on("connect_error",(e=>{console.log(JSON.stringify(e)),console.log("speech socket_connection error"),notification("Caption connection error","failure")})),n.on("error",(e=>{console.log(e),console.log("speech Socket error")})),n.on("chunk-result",(e=>{var t;""!==e.trim()?(u.push(e),t=u.join(""),l=r.x.getdata(),r.x.socketclient.emit("voiceToText",l,t),$("#caption-wrapper").removeClass("intellaTextwrapper").css("display","inline-block").addClass("TranscriptionCaption-wrapper"),$("#caption-wrapper, .main-speaker").css("display","inline-block"),$("#TestingBeta-text").addClass("d-flex").css("display","inline-block"),$("#caption-wrapper .mainspeaker-name").text(l.displayname),$("#caption-wrapper .mainspeaker-text").text(t),clearTimeout(h),h=setTimeout(f,1e4)):(u=[],f())})),n.on("recording-stopped",(()=>{console.log("recording-stopped"),$("#idCaption").hasClass("flaticon-closed-captioning-slash")&&(notification("Caption have been turn off","success"),$("#idCaption").addClass("flaticon-subtitles").removeClass("flaticon-closed-captioning-slash"))})),n.on("disconnect",(()=>{console.log("Disconnected"),notification("Caption was disconnected!","failure")})),n.emit("start-recording",JSON.stringify({api_token:c,accountId:d})),t(),notification("Caption have been turn on","success"),$("#idCaption").removeClass("flaticon-subtitles").addClass("flaticon-closed-captioning-slash"),$("#caption-wrapper").css("display","inline-block").addClass("intellaTextwrapper"),$("#TestingBeta-text").css("display","inline-block")):$("#idCaption").hasClass("flaticon-closed-captioning-slash")&&(g(),notification("Caption have been turn off","success"),$("#idCaption").addClass("flaticon-subtitles").removeClass("flaticon-closed-captioning-slash")):notification("click the audio button & use the caption","warning")}))}));const m=e=>new Promise(((t,i)=>{const r=new FileReader;r.readAsDataURL(e),r.onloadend=()=>{const e=r.result.split(",")[1];t(e)},r.onerror=e=>i(e)}));function f(){u=[],$("#caption-wrapper").removeClass("TranscriptionCaption-wrapper").css("display","none").addClass("intellaTextwrapper"),$("#caption-wrapper, .main-speaker").css("display","none"),$("#caption-wrapper .mainspeaker-text").text(""),$("#caption-wrapper .mainspeaker-name").text(""),$("#caption-wrapper .mainspeaker-text").text(""),$("#TestingBeta-text").removeClass("d-flex").css("display","inline-block")}},964:(e,t,i)=>{var r=i(112);const a=[];var o=document.getElementById("input");function n(){o.value&&(a.push({text:o.value,time:$.format.date(new Date,"h:mm a"),username:r.x.displayname}),function(e){console.log("Type0",e);var t=document.createElement("li");e.forEach((e=>{t.innerHTML=`\n    <div class="d-flex flex-row justify-content-start">\n    <div class="logo-box text-center rounded-2 flex-shrink-0">\n    <div class="avatar  d-flex justify-content-center align-items-center UserSendMessage">\n        <span class="avatar-initial h4 text-white text-uppercase">\n            ${e.username.charAt(0).toUpperCase()}\n        </span>\n</div>\n</div>\n    <div class="participantMsg ps-4 w-100">\n        <div class="d-flex justify-content-between">\n    \t <p class="small participantName mb-1">${e.username}</p>\n   \t <p class="small d-none mb-1 text-muted">${$.format.date(new Date,"h:mm a")}</p>\n   \t</div>\n        <p class="p-2 my-2 text-break text-left bg-white participantMsgTxt" style="text-align: initial;"> ${e.text}</p>\n    </div>\n    </div>`,messages.appendChild(t)}))}(a),o.value&&(r.x.socketclient.emit("sendChat",r.x.getdata(),o.value),o.value=""))}o.addEventListener("keypress",(function(e){"Enter"===e.key&&n()})),$("#sendmessage").click((function(e){n()}))},692:(e,t,i)=>{var r=i(112);let a=new(i(679).E);$(window).on("load",(function(){var e=0;function t(e){var t=~~(e/3600),i=~~(e%3600/60),r=~~e%60,a="";return t>0&&(a+=t+":"+(i<10?"0":"")),(a+=i+":"+(r<10?"0":""))+""+r}function i(e){const t=Date.parse(e)-Date.parse(new Date);return{total:t,minutes:Math.floor(t/1e3/60%60),seconds:Math.floor(t/1e3%60)}}function o(e,o,s){document.getElementById("timeColon").style.display="inline-block";const c=document.getElementById(e),d=c.querySelector(".minutes"),l=c.querySelector(".seconds"),h=setInterval((function(){const e=i(o);if(d.innerHTML=("0"+e.minutes).slice(-2),l.innerHTML=("0"+e.seconds).slice(-2),0==e.total){let e=new Promise((function(e,r){e(function(){if(!u){u=!0,clearInterval(h);const e=i(o);t((e.minutes+":"+e.seconds).split(":").reduce(((e,t)=>60*e+ +t))),i(o).total}}())}));e.then((function(){return setTimeout((()=>{return e=d,t=l,i=s,void setInterval((function(){++i,t.innerHTML=n(i%60),e.innerHTML=n(parseInt(i/60))}),1e3);var e,t,i}),500)}))}}),1e3);r.x.socketclient.on("CountofJoinedUsers",(function(e){if(o){$("#conferencetimer").removeClass("d-none");let i=d.innerText+":"+l.innerText;e.IntialUsersStartedTime=t(s),e.currentTime=i,a.objSocketManager.socketEmit("JoinedUsersTime",e)}})),r.x.socketclient.on("GetReminigTime",(function(e){$("#conferencetimer").removeClass("d-none");let t=d.innerText+":"+l.innerText;e.currentTime=t,e.endtime=o,a.objSocketManager.socketEmit("RunningTime",e)})),r.x.socketclient.on("UserGetReminigTime",(function(e){$("#conferencetimer").removeClass("d-none");let t=d.innerText+":"+l.innerText;e.currentTime=t,e.endtime=o,a.objSocketManager.socketEmit("UserRunningTime",e)}));var u=!1;""!=$("#recordingText")&&$("#clockdiv").css("line-height","1.2")}function n(e){var t=e+"";return t.length<2?"0"+t:t}document.getElementById("timeColon").style.display="none",r.x.socketclient.on("RecordingText",(function(e){if($("#conferencetimer").addClass("RecordTextAdding"),$("#conferencetimer #RecordingSymbol").addClass("recordSymbol"),e.videorecording&&0===$("#recordingText").length){var t='<p id="recordingText" style="color: #b7b7b7; font-size: 1.1rem; "> Video Recording</p>';$("#clockdiv .RecordText").append(t)}else e.audiorecording&&0===$("#recordingText").length&&(t='<p id="recordingText" style="color: #b7b7b7; font-size: 1.1rem; "> Audio Recording</p>',$("#clockdiv .RecordText").append(t))})),r.x.socketclient.on("StartTime",(function(e,t){$("#conferencetimer").removeClass("d-none");var i=e/60;const r=new Date(Date.parse(new Date)+60*i*1e3);localStorage.setItem("starttime",r),o("clockdiv",localStorage.getItem("starttime"),e)})),r.x.socketclient.on("setJoinedUsersTime",(function(t){$("#conferencetimer").removeClass("d-none");var i=t.currentTime.split(":").reduce(((e,t)=>60*e+ +t))/60,r=t.IntialUsersStartedTime.split(":").reduce(((e,t)=>60*e+ +t));1==(e+=1)&&o("clockdiv",new Date(Date.parse(new Date)+60*i*1e3),r)})),r.x.socketclient.on("setReminingTime",(function(e){$("#conferencetimer").removeClass("d-none");var t=e.currentTime.split(":").reduce(((e,t)=>60*e+ +t))/60,i=e.IntialStartedTime.split(":").reduce(((e,t)=>60*e+ +t));o("clockdiv",new Date(Date.parse(new Date)+60*t*1e3),i)})),r.x.socketclient.on("setReminingUserTime",(function(e){$("#conferencetimer").removeClass("d-none");var t=e.currentTime.split(":").reduce(((e,t)=>60*e+ +t))/60,i=e.IntialStartedTime.split(":").reduce(((e,t)=>60*e+ +t));o("clockdiv",new Date(Date.parse(new Date)+60*t*1e3),i)}))}))},581:(e,t,i)=>{var r=i(112),a=i(679),o=i(94);let n=new a.E;function s(){let e=getDataFromLocalStorage();console.log(e),e?(e.isadmin?(document.getElementById("Main").style.display="block",document.getElementById("Waiting").style.display="block",document.getElementById("muteall").style.display="inline-block",document.getElementById("idParticipants").style.display="inline-block",$("#idAudio, .muteall-btn, .Particaipants-btn, #idScreenShot").show()):(document.getElementById("load").style.display="block",$("#idAudio").show()),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/IEMobile/i))&&(document.getElementById("idSettings").style.display="none",document.getElementById("switchcamera").style.display="inline-block"),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPod/i)&&!navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/IEMobile/i))&&window.innerHeight>window.innerWidth&&!navigator.userAgent.match(/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i)?(document.getElementById("idToggle").style.display="inline-block",$(".togglerBlkIn").removeClass("d-inline-block").css("display","none")):window.parent!==window&&window.innerWidth>600&&window.innerWidth<800?(document.getElementById("idToggle").style.display="inline-block",$(".togglerBlkIn").removeClass("d-inline-block").css("display","none"),console.log("its working for ifame Desktop  ")):($("#WrapperToggleBlk").removeClass("togglerBlkIn"),document.getElementById("idToggle").style.display="none"),(navigator.userAgent.match("chrome")||navigator.userAgent.match("Safari"))&&!navigator.userAgent.match("/Android/i")&&!navigator.userAgent.match("/iPhone|iPad|iPod/i")&&!navigator.userAgent.match("/IEMobile/i")&&window.parent!==window&&window.innerWidth>600&&window.innerWidth<800&&(document.getElementById("newtab-btn").style.display="inline-block"),n.joinConference(e,(function(){null!=r.x.localMediaVideoStream&&r.x.localMediaVideoStream.getVideoTracks().length>0&&r.x.localMediaVideoStream.getVideoTracks().forEach(((e,t)=>{let i=r.x.localMediaVideoStream.getVideoTracks()[t].enabled?"Start cam":"Srop cam",a=document.getElementById("idVideo");"Stop cam"==i?(a.classList.remove("flaticon-video-camera"),a.classList.add("flaticon-no-video")):(a.classList.remove("flaticon-no-video"),a.classList.add("flaticon-video-camera"))})),null!=r.x.localMediaAudioStream&&r.x.localMediaAudioStream.getAudioTracks().length>0&&r.x.localMediaAudioStream.getAudioTracks().forEach(((e,t)=>{r.x.localMediaAudioStream.getAudioTracks()[t].enabled=!1;let i=r.x.localMediaAudioStream.getAudioTracks()[t].enabled?"Unmute":"Mute",a=document.getElementById("idAudio");"Mute"==i?(a.classList.remove("flaticon-microphone"),a.classList.add("flaticon-mute-button")):(a.classList.remove("flaticon-mute-button"),a.classList.add("flaticon-microphone"))})),function(e){var t=$("#videoinput");if(t.on("change",d),r.x.videoInput.length>0&&$.each(r.x.videoInput,(function(e,i){t.append('<option value="'+e+'">'+i.label+"</option>")})),r.x.audioInput.length>0){var i=$("#audioinput");i.on("change",d),$.each(r.x.audioInput,(function(e,t){i.append('<option value="'+e+'">'+t.label+"</option>")}))}if(r.x.audioOutput.length>0){var a=$("#audiooutput");$.each(r.x.audioOutput,(function(e,t){a.append('<option value="'+e+'">'+t.label+"</option>")}))}document.getElementById("idEndCall").addEventListener("click",(function(){(0,o.T)()}))}()}))):notification("Invalid data","failure")}$(window).on("load",(function(){!function(e){let t={};t=getDataFromQueryString(),t?s():notification("Please check the query string data","failure")}()}));var c="user";function d(e){"audioinput"==e.target.id&&(r.x.Constraints.audio={audio:{deviceId:{exact:r.x.audioInput[e.target.selectedIndex].deviceId}}},n.objMediaCapture.changeMic((function(e){n.objPeerManager.replaceAudioTrack()}))),"videoinput"==e.target.id&&(r.x.Constraints.video={video:{deviceId:{exact:r.x.videoInput[e.target.selectedIndex].deviceId},aspectRatio:{exact:1.7777777778}}},l())}function l(){n.objMediaCapture.changeCamera((function(e){if(e){let t=document.getElementById("localstream_"+r.x.socketclient.id);t&&(t.srcObject=e),n.objPeerManager.replaceVideoTrack()}}))}document.querySelector("#switchcamera").addEventListener("click",(function(){c="user"==c?"environment":"user",r.x.Constraints.video={video:{facingMode:c,width:{max:1920,min:640},height:{max:1080,min:360},aspectRatio:{exact:1.7777777778}}},l()}),!1),$("#idParticipants").click((function(){$("#participantsNotification").addClass("d-none")})),$("#modalParticipants").on("hidden.bs.modal",(function(){$("#participantsNotification").addClass("d-none")})),$("#idChat").click((function(){$("#chatNotification").addClass("d-none")})),$("#modalChat").on("hidden.bs.modal",(function(){$("#chatNotification").addClass("d-none")})),$(window).resize((function(){(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPod/i)&&!navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/IEMobile/i))&&window.innerHeight>window.innerWidth&&!navigator.userAgent.match(/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i)?(document.getElementById("idToggle").style.display="inline-block",$(".togglerBlkIn").removeClass("d-inline-block")):(document.getElementById("idToggle").style.display="none",$(".togglerBlkIn").addClass("d-inline-block"))}))},572:(e,t,i)=>{var r=i(112),a=i(679),o=(i(94),i(328));let n=new a.E;r.x.socketclient=io(),window.removeguestuser=(e,t)=>{let i={peerid:t};n.objSocketManager.socketEmit("removeguestuser",i)},window.toggleAudio=(e,t)=>{'<a class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Stop Audio</a>'==e.innerHTML?e.innerHTML='<a class="dropdown-item" href="#"><i class="bi bi-mic m-1"></i>Start Audio</a>':e.innerHTML='<a class="dropdown-item" href="#"><i class="bi bi-mic-mute m-1"></i>Stop Audio</a>',n.objPeerManager.toggleAudio(t);let i={peerid:t};n.objSocketManager.socketEmit("toggleaudio",i)},window.toggleVideo=async(e,t)=>{'<a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a>'==e.innerHTML?(e.innerHTML='<a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-camera-video m-1"></i>Start Video</a>',e.querySelector(".bi-camera-video").parentNode.classList.add("videoStopped")):(e.innerHTML='<a id="Dropdown_items" class="dropdown-item" href="#"><i class="bi bi-camera-video-off m-1"></i>Stop Video</a>',e.querySelector(".bi-camera-video-off").parentNode.classList.remove("videoStopped")),n.objPeerManager.toggleVideo(t);let i={peerid:t};n.objSocketManager.socketEmit("togglevideo",i)},window.videoToggle=(e,t)=>{'<a class="videotoggleOn" href="#"><i class="bi bi-camera-video"></i></a>'==e.innerHTML?e.innerHTML='<a class="videotoggleOff" href="#"><i class="bi bi-camera-video-off"></i></a>':e.innerHTML='<a class="videotoggleOn" href="#"><i class="bi bi-camera-video"></i></a>',n.objPeerManager.toggleVideo(t);let i={peerid:t};n.objSocketManager.socketEmit("togglevideo",i)},window.audioToggle=(e,t)=>{'<a class="audioMute" href="#"><i class="bi bi-mic-mute m-2"></i></a>'==e.innerHTML?e.innerHTML='<a class="audiounMute" href="#"><i class="bi bi-mic m-2"></i></a>':e.innerHTML='<a class="audioMute" href="#"><i class="bi bi-mic-mute m-2"></i></a>',n.objPeerManager.toggleAudio(t);let i={peerid:t};n.objSocketManager.socketEmit("toggleaudio",i)},window.toggleFlip=(e,t)=>{let i=document.getElementById("localstream_"+t),a=document.getElementById("preview");if(i){i.classList.toggle("mirroron"),a.classList.toggle("mirroron"),r.x.isadmin&&n.objPeerManager.FlipMedia(t);let e={conferencename:r.x.conferencename,peerid:t};n.objSocketManager.socketEmit("toggleFlip",e)}},$("#idAudio").click((function(e){console.log("audio click"),n.objMediaCapture.toggleMic((function(t){0!=t&&("Mute"==t?(e.target.classList.remove("flaticon-microphone"),e.target.classList.add("flaticon-microphone-off"),e.target.classList.add("selected"),$("#idCaption").hasClass("flaticon-closed-captioning-slash")&&(0,o.X)()):(e.target.classList.remove("flaticon-microphone-off"),e.target.classList.add("flaticon-microphone"),e.target.classList.remove("selected")))}))})),$("#idVideo").click((function(e){console.log("video click"),n.objMediaCapture.toggleVideo((function(t){0!=t&&("Stop cam"==t?(e.target.classList.remove("flaticon-video-camera"),e.target.classList.add("flaticon-no-video"),e.target.classList.add("selected")):(e.target.classList.remove("flaticon-no-video"),e.target.classList.add("flaticon-video-camera"),e.target.classList.remove("selected")))}))})),$("#idEndCall").click((function(e){var t=r.x.getdata();t.peerid=r.x.socketclient.id,n.objSocketManager.socketEmit("endConferenceEvent",t),(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i)||navigator.userAgent.match(/IEMobile/i))&&(r.x.isadmin?n.objSocketManager.socketEmit("endConferenceforeveryone",r.x.getdata()):location.href="conferenceended.html")})),$("#newtab-btn").click((function(e){var t=r.x.getdata();t.newBrowserTab="true",t.peerid=r.x.socketclient.id,n.objSocketManager.socketEmit("NewTabconferenceEventData",t)})),$("#idToggle").click((function(e){e.preventDefault(),$(".togglerBlkIn").toggle(),$(".togglerBlkIn").hasClass("d-inline-block")&&$(".togglerBlkIn").removeClass("d-inline-block")})),$("#ToggleVideoSize").click((e=>{e.preventDefault();var t=/iP(ad|hone|od).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),i=$(".main-videoWrap video"),r=i.css("object-fit"),a=$("#ToggleVideoSize");if(t){const e="cover"===r?"contain":"cover";i.css("object-fit",e),i.addClass("iosToggleVideo"),a.removeClass("flaticon-full-screen flaticon-minimize").addClass("contain"===e?"flaticon-minimize":"flaticon-full-screen"),setTimeout((()=>{i.removeClass("iosToggleVideo")}),1e3)}else{const e="cover"===r?"contain":"cover";i.css("object-fit",e),a.removeClass("flaticon-full-screen flaticon-minimize").addClass("contain"===e?"flaticon-minimize":"flaticon-full-screen")}})),$("#idScreenShot").on("click",(async function(e){e.preventDefault(),document.getElementById("MainCanvas");var t;t=await async function(){return(await html2canvas($(".main-videoWrap").get(0),{willReadFrequently:!0})).toDataURL("image/jpeg",.8)}(),$("#screenshotPreview").attr("src",t),$("#screenshotModal").modal("show"),$("#saveScreenshot").off("click").on("click",(async function(){const e=function(){const e=r.x.getdata().conferencename,t=(new Date).toISOString().replace(/[-:]/g,""),i=$("#imageName").val().trim(),a=r.x.getdata(),o=i?i+"-"+e+t:e+"-"+t;a.imageName=o;const n=function(e){const t=e.split(","),i=t[0].match(/:(.*?);/)[1],r=atob(t[1]),a=r.length,o=new Uint8Array(a);for(let e=0;e<a;e++)o[e]=r.charCodeAt(e);return new Blob([o],{type:i})}($("#screenshotPreview").attr("src"));return a.screenShot=n,i&&$("#imageName").val(""),a}();await async function(e){await n.objSocketManager.socketEmit("storescreenShotImage",e);const t=e.screenShot.size/1048576;console.log("Image size:",t.toFixed(2),"MB")}(e),$("#screenshotModal").modal("hide")})),$("#WrapperToggleBlk").hasClass("togglerBlkIn")&&$(".togglerBlkIn").css("display","none")})),$("#muteall").click((function(e){n.objSocketManager.socketEmit("muteall",r.x.getdata()),notification("All users have been muted","success")}))},442:(e,t,i)=>{class r{constructor(){this.thisVideoparent=null,this.asibling=null,this.thisVideostyle=null,this.thisVideoparentElement=null,this.thishostVideoOffWrap=null,this.mainVideoparentElement=null,this.mainhostVideoOffWrap=null,this.thisVideochildElements=null,this.mainVideochildElements=null}initVideoSwapping(e,t,i){if(console.log("swap video init func"),$(".video-list .videoWrap").length>0&&$(".mainVideo").length>0){var r=t.find(".videoWrap").prevObject,a=$(".main-videoWrap"),o=t.find(".videoWrap").prevObject[0].id,n=$(".main-videoWrap")[0].id,s=a.has(".SupportClass").length>0;if(a.attr("id")!==o?a.attr("id",o):a.attr("id",n),r.attr("id")!==n?r.attr("id",n):r.attr("id",o),s){var c=a.find(".SupportClass").eq(0).attr("id");r.attr("id",c),a.find(".SupportClass").eq(0).removeAttr("id")}var d=t.find("span")[0],l=$(".main-videoWrap").find("span")[0],h=t.find(".videoOffTxt")[0],u=$(".main-videoWrap").find(".videoOffTxt")[0],p=($(".main-videoWrap").find(".videoScreenOff"),t.find("button")[0]),g=$(".main-videoWrap").find("button")[0],m=t.find("ul")[0],f=$(".main-videoWrap").find("ul")[0],v=t.find("video")[0],y=$(".main-videoWrap").find("video")[0];this.swapNodes(v,y,d,l,h,u,p,g,i,m,f,e)}}async swapNodes(e,t,i,r,a,o,n,s,c,d,l,h){console.log("swap video sawap Nodes func");const u=this.checkForIOS(),p=async()=>{this.thisVideoparent=e.parentNode,this.asibling=e.nextSibling===t?e:e.nextSibling,t.parentNode.insertBefore(e,t),this.thisVideoparent.insertBefore(t,this.asibling),this.thisVideostyle=getComputedStyle(e).width,e.removeAttribute("style"),t.style={width:this.thisVideostyle,opacity:"",objectFit:"cover"},this.handleUIIssues(e,t)};u?(e.classList.add("iospipvideoswap"),t.classList.add("iospipvideoswap"),$("#scrollDown").css("opacity","0"),setTimeout((()=>{p().then((()=>{e.style.width="100%",e.classList.remove("iospipvideoswap"),t.classList.remove("iospipvideoswap"),$("#scrollDown").css({opacity:"",display:"none"})}))}),1100)):await p(),this.swapNamesAndDropdown(c,i,r,a,o,n,s,d,l)}checkForIOS(){return/iP(ad|hone|od).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)}handleUIIssues(e,t){this.thisVideoparentElement=e.parentNode,this.mainVideoparentElement=t.parentNode,this.thishostVideoOffWrap=this.thisVideoparentElement.querySelector("#hostVideoOffWrap"),this.mainhostVideoOffWrap=this.mainVideoparentElement.querySelector(".participantVideoOff"),this.handleClassToggle(this.thishostVideoOffWrap,this.mainhostVideoOffWrap)}handleClassToggle(e,t){e.classList.contains("d-none")?console.log("This element has the 'd-none' class."):(console.log("This element does not have the 'd-none' class."),e.classList.add("d-none")),t.classList.contains("d-none")?console.log("Main element has the 'd-none' class."):(console.log("Main element does not have the 'd-none' class."),t.classList.add("d-none"))}swapNamesAndDropdown(e,t,i,r,a,o,n,s,c){const d=t.parentNode,l=t.nextSibling===i?t:t.nextSibling;i.parentNode.insertBefore(t,i),d.insertBefore(i,l);const h=r.innerText,u=a.innerText;if(r.innerText=u,a.innerText=h,i.classList.remove("mt-5","pt-5"),e.isadmin){const e=o.parentNode,t=o.nextSibling===n?o:o.nextSibling;n.parentNode.insertBefore(o,n),e.insertBefore(n,t);const i=s.parentNode,r=s.nextSibling===c?s:s.nextSibling;c.parentNode.insertBefore(s,c),i.insertBefore(c,r)}}}$(document).on("click",".video-list .videoWrap",(function(e){e.preventDefault();var t=getDataFromQueryString();console.log("swap video click"),(new r).initVideoSwapping(e,$(this),t)})),$(document).on("click","#ListVideosWrap #DropDown",(function(e){e.stopPropagation()}))},644:(e,t,i)=>{function r(){var e=$("#ListVideosWrap")[0];$("#ListVideosWrap").length>0&&(e.scrollHeight>e.clientHeight?(console.log("Scroll bar is visible"),$("#scrollDown").show()):(console.log("No scroll bar"),$("#scrollDown").hide()))}i(112),$(window).resize((function(){})),$(window).on("orientationchange",(function(e){console.log("orientationChanges"),"undefined"!=$("#ListVideos .videoWrap").attr("style")&&$("#ListVideos .videoWrap").removeAttr("style")})),$(window).resize((function(){window.innerWidth>600&&window.innerWidth<800&&(document.getElementById("idToggle").style.display="inline-block")}));var a=document.body,o=new MutationObserver((function(e){r()}));a?(o.observe(a,{subtree:!0,childList:!0}),r()):console.log("Target element with ID 'document' not found.")}},t={};function i(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}i.amdO={},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i(581),i(572),i(964),i(692),i(644),i(442),i(328)})();